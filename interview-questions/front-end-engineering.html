<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端工程化 | 二狗摸鱼</title>
    <meta name="description" content="A VitePress Site">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/vitepress_docs/assets/style.4wgRqHns.css" as="style">
    <link rel="preload stylesheet" href="/vitepress_docs/vp-icons.css" as="style">
    
    <script type="module" src="/vitepress_docs/assets/app.CTfYxoWA.js"></script>
    <link rel="preload" href="/vitepress_docs/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/vitepress_docs/assets/chunks/theme.CHTQHbcA.js">
    <link rel="modulepreload" href="/vitepress_docs/assets/chunks/framework.D2181YO2.js">
    <link rel="modulepreload" href="/vitepress_docs/assets/interview-questions_front-end-engineering.md.jcOw1uo6.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/vitepress_docs/" data-v-1e38c6bc><!--[--><!--]--><!----><span data-v-1e38c6bc>二狗摸鱼</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress_docs/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress_docs/markdown-examples.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Examples</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Examples</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/vitepress_docs/" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>首页</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/vitepress_docs/interview-questions.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>前端面试题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/vitepress_docs/api-examples.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Runtime API Examples</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _vitepress_docs_interview-questions_front-end-engineering" data-v-7011f0d8><div><h1 id="前端工程化" tabindex="-1">前端工程化 <a class="header-anchor" href="#前端工程化" aria-label="Permalink to “前端工程化”">​</a></h1><h2 id="webpack-配置有哪些" tabindex="-1">webpack 配置有哪些? <a class="header-anchor" href="#webpack-配置有哪些" aria-label="Permalink to “webpack 配置有哪些?”">​</a></h2><p>Webpack 是一个强大的前端模块打包工具，其核心能力通过 <strong>配置文件 <code>webpack.config.js</code></strong> 进行定制。以下是 <strong>常用且关键的 Webpack 配置项详解</strong>（基于 Webpack 5）：</p><hr><h3 id="一、基础结构" tabindex="-1">一、基础结构 <a class="header-anchor" href="#一、基础结构" aria-label="Permalink to “一、基础结构”">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;development&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;production&#39; | &#39;none&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  entry: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/index.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  output: { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  resolve: { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  devServer: { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  optimization: { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><hr><h3 id="二、核心配置项详解" tabindex="-1">二、核心配置项详解 <a class="header-anchor" href="#二、核心配置项详解" aria-label="Permalink to “二、核心配置项详解”">​</a></h3><h4 id="_1-mode-模式" tabindex="-1">1. <strong><code>mode</code>（模式）</strong> <a class="header-anchor" href="#_1-mode-模式" aria-label="Permalink to “1. mode（模式）”">​</a></h4><ul><li><strong>作用</strong>：设置打包环境，自动启用内置优化。</li><li><strong>选项</strong>： <ul><li><code>&#39;development&#39;</code>：启用 <code>NamedChunksPlugin</code>、<code>EvalSourceMapDevToolPlugin</code>（快速构建 + source map）</li><li><code>&#39;production&#39;</code>：启用代码压缩、作用域提升、Tree Shaking 等</li></ul></li><li><strong>建议</strong>：始终显式指定。</li></ul><h4 id="_2-entry-入口" tabindex="-1">2. <strong><code>entry</code>（入口）</strong> <a class="header-anchor" href="#_2-entry-入口" aria-label="Permalink to “2. entry（入口）”">​</a></h4><ul><li><strong>作用</strong>：指定打包起点。</li><li><strong>用法</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/index.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 单入口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">entry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/app.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  vendor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/vendor.js&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 多入口（用于代码分割）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_3-output-输出" tabindex="-1">3. <strong><code>output</code>（输出）</strong> <a class="header-anchor" href="#_3-output-输出" aria-label="Permalink to “3. output（输出）”">​</a></h4><ul><li><strong>作用</strong>：配置打包结果。</li><li><strong>关键属性</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dist&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 输出目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  filename</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[name].[contenthash].js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 文件名（[name]=入口名，[contenthash]=内容哈希）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  publicPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 资源引用前缀（CDN 场景）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  clean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                            // 构建前清空 output 目录（Webpack 5+）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_4-module-rules-模块规则" tabindex="-1">4. <strong><code>module.rules</code>（模块规则）</strong> <a class="header-anchor" href="#_4-module-rules-模块规则" aria-label="Permalink to “4. module.rules（模块规则）”">​</a></h4><ul><li><strong>作用</strong>：定义如何处理不同类型的模块（如 JS、CSS、图片）。</li><li><strong>核心概念</strong>：<strong>Loader</strong>（转换器）</li><li><strong>常用规则</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 处理 JS/JSX（Babel）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">jsx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      exclude:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">node_modules</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      use: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        loader: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;babel-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options: { presets: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@babel/preset-env&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 处理 CSS</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">css</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      use: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;style-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;css-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;postcss-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 处理图片/字体</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(png</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">jpg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">gif</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">woff2)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;asset&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Webpack 5 内置资源模块</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      parser: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        dataUrlCondition: { maxSize: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 小于 8KB 转 base64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      generator: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        filename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;assets/[name].[hash][ext]&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_5-plugins-插件" tabindex="-1">5. <strong><code>plugins</code>（插件）</strong> <a class="header-anchor" href="#_5-plugins-插件" aria-label="Permalink to “5. plugins（插件）”">​</a></h4><ul><li><strong>作用</strong>：执行范围更广的任务（如优化、压缩、注入变量）。</li><li><strong>常用插件</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> HtmlWebpackPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;html-webpack-plugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MiniCssExtractPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mini-css-extract-plugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DefinePlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;webpack&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).DefinePlugin;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 自动生成 HTML 并注入 bundle</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HtmlWebpackPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ template: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./public/index.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 提取 CSS 到单独文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MiniCssExtractPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ filename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[name].[contenthash].css&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 定义全局常量（如 process.env.NODE_ENV）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefinePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;process.env.API_URL&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://api.example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li></ul><h4 id="_6-resolve-解析" tabindex="-1">6. <strong><code>resolve</code>（解析）</strong> <a class="header-anchor" href="#_6-resolve-解析" aria-label="Permalink to “6. resolve（解析）”">​</a></h4><ul><li><strong>作用</strong>：配置模块解析规则。</li><li><strong>常用配置</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  extensions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.jsx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 导入时省略后缀</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  alias</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;@&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;src&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 路径别名</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;react&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;preact/compat&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 替换依赖（Preact 代替 React）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  modules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;node_modules&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;src&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 模块查找目录</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_7-devserver-开发服务器" tabindex="-1">7. <strong><code>devServer</code>（开发服务器）</strong> <a class="header-anchor" href="#_7-devserver-开发服务器" aria-label="Permalink to “7. devServer（开发服务器）”">​</a></h4><ul><li><strong>作用</strong>：本地开发服务（仅开发环境有效）。</li><li><strong>关键配置</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">devServer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./public&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 静态资源目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  hot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 模块热替换（HMR）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 启动后自动打开浏览器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 代理 API 请求</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;/api&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://localhost:8080&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_8-optimization-优化" tabindex="-1">8. <strong><code>optimization</code>（优化）</strong> <a class="header-anchor" href="#_8-optimization-优化" aria-label="Permalink to “8. optimization（优化）”">​</a></h4><ul><li><strong>作用</strong>：生产环境性能优化。</li><li><strong>关键配置</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  splitChunks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    chunks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 代码分割（提取公共代码）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    cacheGroups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      vendor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/]</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">node_modules</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vendors&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        chunks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  minimize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 是否压缩（production 模式默认 true）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  minimizer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CssMinimizerPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自定义压缩器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h3 id="三、环境区分配置" tabindex="-1">三、环境区分配置 <a class="header-anchor" href="#三、环境区分配置" aria-label="Permalink to “三、环境区分配置”">​</a></h3><p>避免在单个配置文件中混杂开发/生产逻辑：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isProd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argv.mode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;production&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mode: argv.mode,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    devtool: isProd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;source-map&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;eval-cheap-module-source-map&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    plugins: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HtmlWebpackPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        template: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./public/index.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        minify: isProd </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 生产环境压缩 HTML</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>✅ <strong>更佳实践</strong>：使用 <code>webpack-merge</code> 拆分配置文件：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>config/</span></span>
<span class="line"><span>  ├── webpack.common.js</span></span>
<span class="line"><span>  ├── webpack.dev.js</span></span>
<span class="line"><span>  └── webpack.prod.js</span></span></code></pre></div></blockquote><hr><h3 id="四、常用-loader-plugin-速查表" tabindex="-1">四、常用 Loader &amp; Plugin 速查表 <a class="header-anchor" href="#四、常用-loader-plugin-速查表" aria-label="Permalink to “四、常用 Loader &amp; Plugin 速查表”">​</a></h3><table tabindex="0"><thead><tr><th>类型</th><th>名称</th><th>用途</th></tr></thead><tbody><tr><td><strong>JS</strong></td><td><code>babel-loader</code></td><td>转译 ES6+ / JSX</td></tr><tr><td><strong>CSS</strong></td><td><code>css-loader</code> + <code>MiniCssExtractPlugin</code></td><td>处理 CSS 模块化 &amp; 提取</td></tr><tr><td><strong>资源</strong></td><td><code>file-loader</code> / <code>url-loader</code>（Webpack 5 用 <code>asset modules</code>）</td><td>处理图片/字体</td></tr><tr><td><strong>HTML</strong></td><td><code>html-webpack-plugin</code></td><td>生成 HTML 模板</td></tr><tr><td><strong>优化</strong></td><td><code>terser-webpack-plugin</code></td><td>JS 压缩（Webpack 5 内置）</td></tr><tr><td><strong>分析</strong></td><td><code>webpack-bundle-analyzer</code></td><td>可视化 bundle 体积</td></tr></tbody></table><hr><h3 id="五、一句话总结" tabindex="-1">五、一句话总结 <a class="header-anchor" href="#五、一句话总结" aria-label="Permalink to “五、一句话总结”">​</a></h3><blockquote><p><strong>Webpack 配置 = 入口 → 加载器（Loader）处理模块 → 插件（Plugin）增强功能 → 输出优化结果</strong>。<br> 掌握 <code>module.rules</code>、<code>plugins</code>、<code>optimization.splitChunks</code> 三大核心，即可应对 90% 场景。</p></blockquote><h2 id="有哪些常见的-loader-和-plugin" tabindex="-1">有哪些常见的 Loader 和 Plugin？ <a class="header-anchor" href="#有哪些常见的-loader-和-plugin" aria-label="Permalink to “有哪些常见的 Loader 和 Plugin？”">​</a></h2><p>在 Webpack 生态中，<strong>Loader</strong> 用于<strong>转换模块内容</strong>（如将 TypeScript 编译为 JavaScript），<strong>Plugin</strong> 用于<strong>扩展构建流程能力</strong>（如压缩代码、生成 HTML）。以下是 <strong>最常用且实用的 Loader 和 Plugin 列表</strong>（基于 Webpack 5）：</p><hr><h3 id="一、常见-loader-按功能分类" tabindex="-1">一、常见 Loader（按功能分类） <a class="header-anchor" href="#一、常见-loader-按功能分类" aria-label="Permalink to “一、常见 Loader（按功能分类）”">​</a></h3><h4 id="✅-javascript-typescript" tabindex="-1">✅ <strong>JavaScript / TypeScript</strong> <a class="header-anchor" href="#✅-javascript-typescript" aria-label="Permalink to “✅ JavaScript / TypeScript”">​</a></h4><table tabindex="0"><thead><tr><th>Loader</th><th>作用</th><th>安装命令</th></tr></thead><tbody><tr><td><code>babel-loader</code></td><td>转译 ES6+/JSX/TypeScript（需配合 Babel 配置）</td><td><code>npm install -D babel-loader @babel/core</code></td></tr><tr><td><code>ts-loader</code></td><td>直接编译 TypeScript（比 Babel 更完整支持 TS 类型）</td><td><code>npm install -D ts-loader typescript</code></td></tr></tbody></table><blockquote><p>💡 推荐：用 <code>babel-loader</code> + <code>@babel/preset-typescript</code> 处理 TS（更快，适合 React 项目）。</p></blockquote><hr><h4 id="✅-css-预处理器" tabindex="-1">✅ <strong>CSS / 预处理器</strong> <a class="header-anchor" href="#✅-css-预处理器" aria-label="Permalink to “✅ CSS / 预处理器”">​</a></h4><table tabindex="0"><thead><tr><th>Loader</th><th>作用</th><th>说明</th></tr></thead><tbody><tr><td><code>css-loader</code></td><td>解析 CSS 中的 <code>@import</code> 和 <code>url()</code></td><td>必须配合其他 loader 使用</td></tr><tr><td><code>style-loader</code></td><td>将 CSS 注入 <code>&lt;style&gt;</code> 标签（开发环境）</td><td>不适合生产环境</td></tr><tr><td><code>MiniCssExtractPlugin.loader</code></td><td><strong>提取 CSS 为独立文件</strong>（生产环境必备）</td><td>需搭配 <code>mini-css-extract-plugin</code></td></tr><tr><td><code>sass-loader</code></td><td>编译 Sass/SCSS</td><td>依赖 <code>node-sass</code> 或 <code>sass</code></td></tr><tr><td><code>less-loader</code></td><td>编译 Less</td><td>依赖 <code>less</code></td></tr><tr><td><code>postcss-loader</code></td><td>自动添加浏览器前缀（配合 <code>autoprefixer</code>）</td><td>需配置 <code>postcss.config.js</code></td></tr></tbody></table><blockquote><p>📌 <strong>典型 CSS 链</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 开发环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;style-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;css-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;postcss-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 生产环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [MiniCssExtractPlugin.loader, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;css-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;postcss-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></blockquote><hr><h4 id="✅-资源文件-图片-字体-媒体" tabindex="-1">✅ <strong>资源文件（图片/字体/媒体）</strong> <a class="header-anchor" href="#✅-资源文件-图片-字体-媒体" aria-label="Permalink to “✅ 资源文件（图片/字体/媒体）”">​</a></h4><p>Webpack 5 <strong>内置 Asset Modules</strong>，无需额外 loader：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(png</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">jpg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">gif</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">svg)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;asset&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自动选择 asset/resource 或 asset/inline</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        parser: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          dataUrlCondition: { maxSize: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &lt;8KB 转 base64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        generator: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          filename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;images/[name].[hash][ext]&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(woff</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">woff2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">eot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">ttf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">otf)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;asset/resource&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 强制输出为文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        generator: { filename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fonts/[name][ext]&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>⚠️ Webpack 4 用户需用 <code>file-loader</code> / <code>url-loader</code>。</p></blockquote><hr><h4 id="✅-其他" tabindex="-1">✅ <strong>其他</strong> <a class="header-anchor" href="#✅-其他" aria-label="Permalink to “✅ 其他”">​</a></h4><table tabindex="0"><thead><tr><th>Loader</th><th>作用</th></tr></thead><tbody><tr><td><code>html-loader</code></td><td>处理 HTML 中的 <code>&lt;img src=&quot;...&quot;&gt;</code> 等资源引用</td></tr><tr><td><code>vue-loader</code></td><td>编译 Vue 单文件组件（<code>.vue</code>）</td></tr><tr><td><code>worker-loader</code></td><td>将 JS 文件作为 Web Worker 加载</td></tr></tbody></table><hr><h3 id="二、常见-plugin-按功能分类" tabindex="-1">二、常见 Plugin（按功能分类） <a class="header-anchor" href="#二、常见-plugin-按功能分类" aria-label="Permalink to “二、常见 Plugin（按功能分类）”">​</a></h3><h4 id="✅-核心功能" tabindex="-1">✅ <strong>核心功能</strong> <a class="header-anchor" href="#✅-核心功能" aria-label="Permalink to “✅ 核心功能”">​</a></h4><table tabindex="0"><thead><tr><th>Plugin</th><th>作用</th><th>安装命令</th></tr></thead><tbody><tr><td><code>HtmlWebpackPlugin</code></td><td>自动生成 HTML 并自动注入 bundle</td><td><code>npm install -D html-webpack-plugin</code></td></tr><tr><td><code>DefinePlugin</code></td><td>定义全局常量（如 <code>process.env.NODE_ENV</code>）</td><td><strong>Webpack 内置</strong></td></tr><tr><td><code>ProvidePlugin</code></td><td>自动加载模块（如 <code>$</code> → <code>jquery</code>）</td><td><strong>Webpack 内置</strong></td></tr></tbody></table><blockquote><p><strong>HtmlWebpackPlugin 示例</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HtmlWebpackPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  template: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./public/index.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  minify: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 生产环境压缩 HTML</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></blockquote><hr><h4 id="✅-代码优化" tabindex="-1">✅ <strong>代码优化</strong> <a class="header-anchor" href="#✅-代码优化" aria-label="Permalink to “✅ 代码优化”">​</a></h4><table tabindex="0"><thead><tr><th>Plugin</th><th>作用</th></tr></thead><tbody><tr><td><code>MiniCssExtractPlugin</code></td><td><strong>提取 CSS 到独立文件</strong>（替代 <code>style-loader</code>）</td></tr><tr><td><code>CssMinimizerPlugin</code></td><td>压缩 CSS（Webpack 5 需手动配置）</td></tr><tr><td><code>TerserWebpackPlugin</code></td><td>压缩 JS（Webpack 5 生产模式默认启用）</td></tr><tr><td><code>CompressionPlugin</code></td><td>生成 gzip/brotli 压缩文件</td></tr></tbody></table><blockquote><p><strong>MiniCssExtractPlugin 示例</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MiniCssExtractPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mini-css-extract-plugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MiniCssExtractAssistantPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use: [MiniCssExtractPlugin.loader, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;css-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></blockquote><hr><h4 id="✅-性能分析-调试" tabindex="-1">✅ <strong>性能分析 &amp; 调试</strong> <a class="header-anchor" href="#✅-性能分析-调试" aria-label="Permalink to “✅ 性能分析 &amp; 调试”">​</a></h4><table tabindex="0"><thead><tr><th>Plugin</th><th>作用</th></tr></thead><tbody><tr><td><code>webpack-bundle-analyzer</code></td><td>可视化 bundle 体积（排查过大依赖）</td></tr><tr><td><code>SpeedMeasurePlugin</code></td><td>分析各 loader/plugin 耗时</td></tr></tbody></table><blockquote><p><strong>Bundle Analyzer 使用</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BundleAnalyzerPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;webpack-bundle-analyzer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).BundleAnalyzerPlugin;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BundleAnalyzerPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 构建后自动打开分析页面</span></span></code></pre></div></blockquote><hr><h4 id="✅-高级功能" tabindex="-1">✅ <strong>高级功能</strong> <a class="header-anchor" href="#✅-高级功能" aria-label="Permalink to “✅ 高级功能”">​</a></h4><table tabindex="0"><thead><tr><th>Plugin</th><th>作用</th></tr></thead><tbody><tr><td><code>CopyWebpackPlugin</code></td><td>复制静态资源到输出目录（如 <code>public</code> 文件夹）</td></tr><tr><td><code>CleanWebpackPlugin</code></td><td>清空输出目录（Webpack 5 可用 <code>output.clean: true</code> 替代）</td></tr><tr><td><code>HotModuleReplacementPlugin</code></td><td>启用模块热更新（HMR）（Webpack 5 开发服务器默认启用）</td></tr></tbody></table><hr><h3 id="三、快速参考表" tabindex="-1">三、快速参考表 <a class="header-anchor" href="#三、快速参考表" aria-label="Permalink to “三、快速参考表”">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>推荐组合</th></tr></thead><tbody><tr><td><strong>React 项目</strong></td><td><code>babel-loader</code> + <code>HtmlWebpackPlugin</code> + <code>MiniCssExtractPlugin</code></td></tr><tr><td><strong>Vue 项目</strong></td><td><code>vue-loader</code> + <code>vue-style-loader</code></td></tr><tr><td><strong>TypeScript 项目</strong></td><td><code>ts-loader</code> 或 <code>babel-loader</code> + <code>fork-ts-checker-webpack-plugin</code>（类型检查）</td></tr><tr><td><strong>生产环境 CSS</strong></td><td><code>MiniCssExtractPlugin.loader</code> + <code>CssMinimizerPlugin</code></td></tr><tr><td><strong>性能分析</strong></td><td><code>webpack-bundle-analyzer</code></td></tr></tbody></table><hr><h3 id="一句话总结" tabindex="-1">一句话总结： <a class="header-anchor" href="#一句话总结" aria-label="Permalink to “一句话总结：”">​</a></h3><blockquote><p><strong>Loader 负责“翻译”文件（如 JS→JS、Sass→CSS），Plugin 负责“加工”构建流程（如压缩、生成文件）——二者协同完成从源码到生产包的转化。</strong></p></blockquote><h2 id="loader和plugin的区别" tabindex="-1">Loader和Plugin的区别 <a class="header-anchor" href="#loader和plugin的区别" aria-label="Permalink to “Loader和Plugin的区别”">​</a></h2><p><code>Loader</code> 和 <code>Plugin</code> 是 Webpack 中两个核心扩展机制，<strong>职责不同、运行时机不同、使用方式也不同</strong>。理解它们的区别是掌握 Webpack 配置的关键。</p><hr><h3 id="一、核心区别概览" tabindex="-1">一、核心区别概览 <a class="header-anchor" href="#一、核心区别概览" aria-label="Permalink to “一、核心区别概览”">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th><strong>Loader</strong></th><th><strong>Plugin</strong></th></tr></thead><tbody><tr><td><strong>作用</strong></td><td><strong>转换模块内容</strong>（如把 Sass 编译成 CSS）</td><td><strong>扩展 Webpack 构建流程能力</strong>（如压缩代码、生成 HTML）</td></tr><tr><td><strong>工作阶段</strong></td><td><strong>模块加载时</strong>（module resolution &amp; transformation）</td><td><strong>整个构建生命周期</strong>（从开始到结束的任意钩子）</td></tr><tr><td><strong>配置位置</strong></td><td><code>module.rules</code> 数组中</td><td><code>plugins</code> 数组中</td></tr><tr><td><strong>输入/输出</strong></td><td>接收<strong>文件内容</strong>（字符串/Buffer），返回<strong>新内容</strong></td><td>接收 <strong>Webpack 编译器（compiler）或编译对象（compilation）</strong></td></tr><tr><td><strong>粒度</strong></td><td><strong>单个模块级别</strong></td><td><strong>整个构建过程级别</strong></td></tr></tbody></table><hr><h3 id="二、形象比喻" tabindex="-1">二、形象比喻 <a class="header-anchor" href="#二、形象比喻" aria-label="Permalink to “二、形象比喻”">​</a></h3><ul><li><p><strong>Loader 像“翻译官”</strong>：<br> 当 Webpack 遇到一个它不认识的文件（比如 <code>.scss</code>），就找对应的 Loader（<code>sass-loader</code>）把它“翻译”成 Webpack 能处理的 JavaScript 模块。</p></li><li><p><strong>Plugin 像“项目经理”</strong>：<br> 它不关心具体某个文件怎么处理，而是监控整个打包流程，在合适时机介入——比如打包完成后自动生成 HTML 文件（<code>HtmlWebpackPlugin</code>），或在代码压缩前做性能分析。</p></li></ul><hr><h3 id="三、代码示例对比" tabindex="-1">三、代码示例对比 <a class="header-anchor" href="#三、代码示例对比" aria-label="Permalink to “三、代码示例对比”">​</a></h3><h4 id="✅-loader-示例-处理-css" tabindex="-1">✅ Loader 示例：处理 CSS <a class="header-anchor" href="#✅-loader-示例-处理-css" aria-label="Permalink to “✅ Loader 示例：处理 CSS”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">css</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        use: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;style-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;css-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ← 这是 Loader</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><strong>作用</strong>：将 <code>import &#39;./style.css&#39;</code> 转换为 JS 代码，动态插入 <code>&lt;style&gt;</code> 标签。</li></ul><h4 id="✅-plugin-示例-生成-html" tabindex="-1">✅ Plugin 示例：生成 HTML <a class="header-anchor" href="#✅-plugin-示例-生成-html" aria-label="Permalink to “✅ Plugin 示例：生成 HTML”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> HtmlWebpackPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;html-webpack-plugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HtmlWebpackPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ template: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/index.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ← 这是 Plugin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><strong>作用</strong>：在打包结束后，自动生成一个引用了 bundle 的 <code>index.html</code>。</li></ul><hr><h3 id="四、运行时机差异-关键" tabindex="-1">四、运行时机差异（关键！） <a class="header-anchor" href="#四、运行时机差异-关键" aria-label="Permalink to “四、运行时机差异（关键！）”">​</a></h3><p>Webpack 构建流程简化如下：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>启动 → 解析入口 → </span></span>
<span class="line"><span>  ┌─ 遇到 import 模块 → 调用对应 Loader 转换内容 → </span></span>
<span class="line"><span>  └─ 所有模块处理完 → 触发 Plugin 的各种钩子（emit, done...）→ 输出文件</span></span></code></pre></div><ul><li><strong>Loader</strong> 只在 <strong>模块被加载时触发</strong>（每个匹配的文件都会调用）；</li><li><strong>Plugin</strong> 可以在 <strong>任何生命周期钩子</strong> 中执行（如 <code>compile</code>, <code>emit</code>, <code>done</code>）。</li></ul><blockquote><p>💡 例如：<code>HtmlWebpackPlugin</code> 在 <code>emit</code> 阶段生成 HTML；<code>TerserWebpackPlugin</code> 在 <code>optimize-chunk-assets</code> 阶段压缩代码。</p></blockquote><hr><h3 id="五、常见误区" tabindex="-1">五、常见误区 <a class="header-anchor" href="#五、常见误区" aria-label="Permalink to “五、常见误区”">​</a></h3><h4 id="❌-误区1-plugin-也能处理文件" tabindex="-1">❌ 误区1：Plugin 也能处理文件？ <a class="header-anchor" href="#❌-误区1-plugin-也能处理文件" aria-label="Permalink to “❌ 误区1：Plugin 也能处理文件？”">​</a></h4><ul><li><strong>部分正确</strong>：有些 Plugin 会操作文件（如 <code>CopyWebpackPlugin</code>），但它<strong>不是转换模块内容</strong>，而是<strong>在构建后复制静态资源</strong>，和 Loader 的“按需转换”本质不同。</li></ul><h4 id="❌-误区2-loader-能做优化" tabindex="-1">❌ 误区2：Loader 能做优化？ <a class="header-anchor" href="#❌-误区2-loader-能做优化" aria-label="Permalink to “❌ 误区2：Loader 能做优化？”">​</a></h4><ul><li><strong>不能</strong>：Loader 只负责“翻译”，代码压缩、Tree Shaking 等优化必须由 Plugin 或 Webpack 内置机制完成。</li></ul><hr><h3 id="六、一句话总结" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>Loader 负责“读懂”各种文件（转换模块），Plugin 负责“掌控”整个打包流程（增强功能）——前者是“翻译器”，后者是“指挥官”。</strong></p></blockquote><h2 id="webpack-的构建流程" tabindex="-1">webpack 的构建流程 <a class="header-anchor" href="#webpack-的构建流程" aria-label="Permalink to “webpack 的构建流程”">​</a></h2><p>Webpack 的构建流程是一个高度模块化、基于事件驱动的编译过程。理解其内部机制，有助于优化配置、调试问题和开发自定义插件。以下是 <strong>Webpack 5 的完整构建流程详解</strong>：</p><hr><h3 id="一、整体流程概览-7-个核心阶段" tabindex="-1">一、整体流程概览（7 个核心阶段） <a class="header-anchor" href="#一、整体流程概览-7-个核心阶段" aria-label="Permalink to “一、整体流程概览（7 个核心阶段）”">​</a></h3><p><img src="/vitepress_docs/assets/tongyi-mermaid-2026-01-05-134002.BphjpqMO.png" alt="An Image"></p><hr><h3 id="二、详细阶段解析" tabindex="-1">二、详细阶段解析 <a class="header-anchor" href="#二、详细阶段解析" aria-label="Permalink to “二、详细阶段解析”">​</a></h3><h4 id="_1-初始化参数-initialization" tabindex="-1">1. <strong>初始化参数（Initialization）</strong> <a class="header-anchor" href="#_1-初始化参数-initialization" aria-label="Permalink to “1. 初始化参数（Initialization）”">​</a></h4><ul><li>合并命令行参数（<code>webpack --mode production</code>）与配置文件（<code>webpack.config.js</code>）；</li><li>得到最终配置对象。</li></ul><h4 id="_2-创建-compiler-对象" tabindex="-1">2. <strong>创建 Compiler 对象</strong> <a class="header-anchor" href="#_2-创建-compiler-对象" aria-label="Permalink to “2. 创建 Compiler 对象”">​</a></h4><ul><li><code>Compiler</code> 是 Webpack 的<strong>全局单例</strong>，负责： <ul><li>管理配置；</li><li>注册插件（通过 <code>compiler.hooks</code>）；</li><li>控制整个生命周期。</li></ul></li><li>此时触发 <code>compiler.hooks.initialize</code> 钩子。</li></ul><h4 id="_3-确定入口-entry" tabindex="-1">3. <strong>确定入口（Entry）</strong> <a class="header-anchor" href="#_3-确定入口-entry" aria-label="Permalink to “3. 确定入口（Entry）”">​</a></h4><ul><li>根据 <code>entry</code> 配置找到所有入口文件（如 <code>./src/index.js</code>）；</li><li>为每个入口创建一个 <strong>依赖（Dependency）</strong> 对象。</li></ul><h4 id="_4-编译模块-compilation" tabindex="-1">4. <strong>编译模块（Compilation）</strong> <a class="header-anchor" href="#_4-编译模块-compilation" aria-label="Permalink to “4. 编译模块（Compilation）”">​</a></h4><blockquote><p>⚠️ <strong>核心阶段！</strong> 每次构建都会创建一个新的 <code>Compilation</code> 对象（包含当前构建的所有模块信息）。</p></blockquote><h5 id="子流程" tabindex="-1">子流程： <a class="header-anchor" href="#子流程" aria-label="Permalink to “子流程：”">​</a></h5><ol><li><p><strong>开始编译</strong></p><ul><li>触发 <code>compiler.hooks.make</code> 钩子；</li><li>从入口开始递归解析依赖。</li></ul></li><li><p><strong>模块解析（Resolve）</strong></p><ul><li>调用 <code>enhanced-resolve</code> 库，根据 <code>resolve</code> 配置查找文件；</li><li>例如：<code>import _ from &#39;lodash&#39;</code> → 定位到 <code>node_modules/lodash/index.js</code>。</li></ul></li><li><p><strong>模块加载（Load）</strong></p><ul><li>根据文件类型匹配 <code>module.rules</code> 中的 Loader；</li><li><strong>Loader 链式调用</strong>（从右到左）：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;style-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;css-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 实际执行：css-loader → style-loader</span></span></code></pre></div></li></ul></li><li><p><strong>模块构建（Build）</strong></p><ul><li>将 Loader 处理后的内容转换为 <strong>AST（抽象语法树）</strong>；</li><li>分析 <code>import</code>/<code>require</code> 语句，收集依赖。</li></ul></li><li><p><strong>依赖收集（Dependency）</strong></p><ul><li>递归处理所有依赖模块（深度优先）；</li><li>构建完整的 <strong>模块依赖图（Module Graph）</strong>。</li></ul></li></ol><h4 id="_5-完成模块依赖图" tabindex="-1">5. <strong>完成模块依赖图</strong> <a class="header-anchor" href="#_5-完成模块依赖图" aria-label="Permalink to “5. 完成模块依赖图”">​</a></h4><ul><li>所有模块构建完成后，触发 <code>compilation.hooks.finishModules</code>；</li><li>执行 <strong>代码分割（SplitChunks）</strong> 和 <strong>Tree Shaking</strong>（基于 ES Module 静态分析）。</li></ul><h4 id="_6-优化与生成资源-seal-optimize" tabindex="-1">6. <strong>优化与生成资源（Seal &amp; Optimize）</strong> <a class="header-anchor" href="#_6-优化与生成资源-seal-optimize" aria-label="Permalink to “6. 优化与生成资源（Seal &amp; Optimize）”">​</a></h4><ul><li><strong>Seal（封装）</strong>： <ul><li>将模块按 Chunk 分组（如 <code>main.js</code>, <code>vendor.js</code>）；</li><li>触发 <code>compilation.hooks.seal</code>。</li></ul></li><li><strong>优化阶段</strong>： <ul><li>压缩代码（<code>TerserPlugin</code>）；</li><li>提取 CSS（<code>MiniCssExtractPlugin</code>）；</li><li>生成哈希值（<code>[contenthash]</code>）。</li></ul></li><li><strong>生成资源</strong>： <ul><li>将 Chunk 转换为最终 assets（如 <code>main.a1b2c3.js</code>）；</li><li>触发 <code>compilation.hooks.processAssets</code>。</li></ul></li></ul><h4 id="_7-输出文件-emit" tabindex="-1">7. <strong>输出文件（Emit）</strong> <a class="header-anchor" href="#_7-输出文件-emit" aria-label="Permalink to “7. 输出文件（Emit）”">​</a></h4><ul><li>触发 <code>compiler.hhooks.emit</code> 钩子（<strong>Plugin 常在此阶段生成额外文件</strong>，如 <code>HtmlWebpackPlugin</code>）；</li><li>将 assets 写入 <code>output.path</code> 目录；</li><li>触发 <code>compiler.hooks.done</code>，构建结束。</li></ul><hr><h3 id="三、关键对象关系" tabindex="-1">三、关键对象关系 <a class="header-anchor" href="#三、关键对象关系" aria-label="Permalink to “三、关键对象关系”">​</a></h3><table tabindex="0"><thead><tr><th>对象</th><th>作用</th><th>生命周期</th></tr></thead><tbody><tr><td><strong><code>Compiler</code></strong></td><td>全局构建管理器</td><td><strong>单例</strong>，贯穿整个 Webpack 运行时</td></tr><tr><td><strong><code>Compilation</code></strong></td><td>单次构建的上下文</td><td><strong>每次构建新建</strong>，包含模块/Chunk/assets</td></tr><tr><td><strong><code>Module</code></strong></td><td>表示一个源文件（如 JS/CSS）</td><td>在 Compilation 中创建</td></tr><tr><td><strong><code>Chunk</code></strong></td><td>代码分割后的代码块</td><td>由多个 Module 组成</td></tr><tr><td><strong><code>Asset</code></strong></td><td>最终输出的文件（如 <code>.js</code>, <code>.css</code>）</td><td>由 Chunk 生成</td></tr></tbody></table><hr><h3 id="四、plugin-如何介入流程" tabindex="-1">四、Plugin 如何介入流程？ <a class="header-anchor" href="#四、plugin-如何介入流程" aria-label="Permalink to “四、Plugin 如何介入流程？”">​</a></h3><p>Plugin 通过 <strong>Tapable 钩子</strong> 监听 Compiler/Compilation 事件：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 监听编译开始</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.run.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MyPlugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;构建开始&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 监听文件输出前</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.emit.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tapAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MyPlugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      compilation.assets[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 添加新文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      };</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><blockquote><p>🔑 <strong>核心钩子</strong>：</p><ul><li><code>make</code>：开始解析模块；</li><li><code>emit</code>：输出文件前；</li><li><code>done</code>：构建完成。</li></ul></blockquote><hr><h3 id="五、loader-的执行时机" tabindex="-1">五、Loader 的执行时机 <a class="header-anchor" href="#五、loader-的执行时机" aria-label="Permalink to “五、Loader 的执行时机”">​</a></h3><ul><li><strong>仅在模块构建阶段（Step 4.3）触发</strong>；</li><li>每个匹配的文件独立调用 Loader 链；</li><li>Loader 本质是 <strong>同步/异步函数</strong>，接收文件内容并返回新内容。</li></ul><hr><h3 id="六、一句话总结-1" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-1" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>Webpack 构建 = 初始化 → 创建 Compiler → 递归解析模块（Loader 转换）→ 生成依赖图 → 优化分块（Plugin 介入）→ 输出文件</strong>，<br> 其中 <strong>Compiler 管全局，Compilation 管单次构建，Loader 转模块，Plugin 控流程</strong>。</p></blockquote><h2 id="什么是webpack的热更新-hot-module-replacement-原理是什么" tabindex="-1">什么是Webpack的热更新（Hot Module Replacement）？原理是什么？ <a class="header-anchor" href="#什么是webpack的热更新-hot-module-replacement-原理是什么" aria-label="Permalink to “什么是Webpack的热更新（Hot Module Replacement）？原理是什么？”">​</a></h2><p>Webpack 的 <strong>热更新（Hot Module Replacement, HMR）</strong> 是一种在<strong>不刷新整个页面</strong>的情况下，<strong>实时替换、添加或删除模块</strong>的开发功能。它极大提升了开发体验——修改代码后，只更新受影响的部分，状态（如 React 组件 state、Vuex 数据）得以保留。</p><hr><h3 id="一、hmr-vs-live-reload" tabindex="-1">一、HMR vs Live Reload <a class="header-anchor" href="#一、hmr-vs-live-reload" aria-label="Permalink to “一、HMR vs Live Reload”">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th>Live Reload</th><th>HMR</th></tr></thead><tbody><tr><td><strong>页面刷新</strong></td><td>✅ 整页刷新</td><td>❌ 不刷新</td></tr><tr><td><strong>状态保留</strong></td><td>❌ 丢失所有状态</td><td>✅ 保留运行时状态</td></tr><tr><td><strong>更新粒度</strong></td><td>整个页面</td><td>单个模块（如一个组件）</td></tr><tr><td><strong>适用场景</strong></td><td>简单静态页</td><td>复杂 SPA（React/Vue）</td></tr></tbody></table><blockquote><p>💡 <strong>HMR 是 Live Reload 的超集</strong>：当 HMR 无法处理时，会降级为页面刷新。</p></blockquote><hr><h3 id="二、hmr-工作原理-核心流程" tabindex="-1">二、HMR 工作原理（核心流程） <a class="header-anchor" href="#二、hmr-工作原理-核心流程" aria-label="Permalink to “二、HMR 工作原理（核心流程）”">​</a></h3><p><img src="/vitepress_docs/assets/tongyi-mermaid-2026-01-05-134344.08Ecg2LM.png" alt="An Image"></p><h4 id="详细步骤" tabindex="-1">详细步骤： <a class="header-anchor" href="#详细步骤" aria-label="Permalink to “详细步骤：”">​</a></h4><ol><li><p><strong>建立连接</strong></p><ul><li>启动 <code>webpack-dev-server</code> 时，自动注入 HMR 客户端代码；</li><li>浏览器与 Dev Server 通过 <strong>WebSocket</strong> 建立长连接。</li></ul></li><li><p><strong>文件变更检测</strong></p><ul><li>Dev Server 监听文件系统变化（如保存 <code>Button.jsx</code>）；</li><li>触发 Webpack <strong>增量编译</strong>，生成： <ul><li><code>hash.hot-update.json</code>：描述变更的模块列表；</li><li><code>hash.hot-update.js</code>：包含新模块代码的 JS 文件。</li></ul></li></ul></li><li><p><strong>推送更新</strong></p><ul><li>Dev Server 通过 WebSocket 将 <strong>hash 值</strong> 推送给浏览器；</li><li>浏览器发起 AJAX 请求获取 <code>hot-update.json</code> 和 <code>hot-update.js</code>。</li></ul></li><li><p><strong>应用更新</strong></p><ul><li>Webpack 运行时（Runtime）接收新模块；</li><li><strong>关键</strong>：检查模块是否声明了 <code>module.hot.accept()</code>： <ul><li>✅ 若有：执行自定义更新逻辑（如 React 替换组件）；</li><li>❌ 若无：触发 <strong>页面刷新</strong>（降级行为）。</li></ul></li></ul></li></ol><hr><h3 id="三、hmr-的两种实现方式" tabindex="-1">三、HMR 的两种实现方式 <a class="header-anchor" href="#三、hmr-的两种实现方式" aria-label="Permalink to “三、HMR 的两种实现方式”">​</a></h3><h4 id="_1-手动编写-accept-逻辑-底层" tabindex="-1">1. <strong>手动编写 <code>accept</code> 逻辑（底层）</strong> <a class="header-anchor" href="#_1-手动编写-accept-逻辑-底层" aria-label="Permalink to “1. 手动编写 accept 逻辑（底层）”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// button.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Button</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Click me&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// index.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Button } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./button&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 声明接受 button 模块的更新</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hot) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">accept</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./button&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 重新渲染按钮（保留父组件状态）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">App</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> newButton</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{Button} /&gt;);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="_2-框架集成-推荐" tabindex="-1">2. <strong>框架集成（推荐）</strong> <a class="header-anchor" href="#_2-框架集成-推荐" aria-label="Permalink to “2. 框架集成（推荐）”">​</a></h4><ul><li><strong>React</strong>：通过 <code>react-refresh</code> + <code>@pmmmwh/react-refresh-webpack-plugin</code><br> → 自动 patch 组件，无需手动写 <code>accept</code>。</li><li><strong>Vue</strong>：Vue Loader 内置 HMR 支持<br> → 单文件组件修改后自动更新。</li><li><strong>其他</strong>：Svelte、Angular 等均有官方 HMR 方案。</li></ul><blockquote><p>✅ <strong>现代开发中，99% 场景无需手动配置 HMR</strong>，框架脚手架已集成。</p></blockquote><hr><h3 id="四、hmr-的局限性" tabindex="-1">四、HMR 的局限性 <a class="header-anchor" href="#四、hmr-的局限性" aria-label="Permalink to “四、HMR 的局限性”">​</a></h3><ul><li><strong>仅限开发环境</strong>：生产环境需关闭（<code>hot: false</code>）；</li><li><strong>状态保留有条件</strong>： <ul><li>React：函数组件状态可保留，类组件需配合 <code>react-hot-loader</code>（已废弃，改用 Fast Refresh）；</li><li>全局变量/模块级状态（如 Redux store）需额外配置（如 <code>redux-hmr</code>）；</li></ul></li><li><strong>无法处理</strong>： <ul><li>入口文件（entry）修改；</li><li>依赖树根节点变更；</li><li>CSS 默认支持 HMR（无需配置），但 JS 需框架支持。</li></ul></li></ul><hr><h3 id="五、如何启用-hmr" tabindex="-1">五、如何启用 HMR？ <a class="header-anchor" href="#五、如何启用-hmr" aria-label="Permalink to “五、如何启用 HMR？”">​</a></h3><h4 id="方法-1-webpack-dev-server-最常用" tabindex="-1">方法 1：<code>webpack-dev-server</code>（最常用） <a class="header-anchor" href="#方法-1-webpack-dev-server-最常用" aria-label="Permalink to “方法 1：webpack-dev-server（最常用）”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  devServer: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    hot: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 启用 HMR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="方法-2-node-js-api" tabindex="-1">方法 2：Node.js API <a class="header-anchor" href="#方法-2-node-js-api" aria-label="Permalink to “方法 2：Node.js API”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> webpack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;webpack&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compiler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> webpack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WebpackDevServer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(compiler, { hot: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div><blockquote><p>⚠️ <strong>注意</strong>：</p><ul><li>Webpack 5 中 <code>HotModuleReplacementPlugin</code> <strong>默认启用</strong>（当 <code>hot: true</code> 时）；</li><li>无需手动添加该插件！</li></ul></blockquote><hr><h3 id="六、一句话总结-2" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-2" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>HMR 通过 WebSocket 监听文件变化，增量编译并推送新模块，结合 <code>module.hot.accept()</code> 实现页面局部更新——它是现代前端开发“秒级反馈”体验的核心技术。</strong></p></blockquote><h2 id="什么是code-splitting" tabindex="-1">什么是Code Splitting <a class="header-anchor" href="#什么是code-splitting" aria-label="Permalink to “什么是Code Splitting”">​</a></h2><p><strong>Code Splitting（代码分割）</strong> 是 Webpack 提供的一种优化技术，用于将<strong>庞大的 JavaScript bundle 拆分成多个较小的 chunk（代码块）</strong>，实现<strong>按需加载（Lazy Loading）</strong> 或 <strong>并行加载</strong>，从而显著提升应用的<strong>首屏加载速度</strong>和<strong>运行时性能</strong>。</p><hr><h3 id="一、为什么需要-code-splitting" tabindex="-1">一、为什么需要 Code Splitting？ <a class="header-anchor" href="#一、为什么需要-code-splitting" aria-label="Permalink to “一、为什么需要 Code Splitting？”">​</a></h3><ul><li><strong>问题</strong>：单个 bundle 文件过大（如 2MB），用户需等待全部下载、解析后才能交互；</li><li><strong>解决方案</strong>： <ul><li>首屏只加载必要代码；</li><li>其他功能代码在需要时再加载（如路由切换、模态框打开）；</li><li>利用浏览器缓存：公共代码单独打包，更新时仅变动业务代码。</li></ul></li></ul><blockquote><p>✅ <strong>核心目标</strong>：减少初始加载体积，提升用户体验（尤其移动端/弱网环境）。</p></blockquote><hr><h3 id="二、code-splitting-的三种主要方式" tabindex="-1">二、Code Splitting 的三种主要方式 <a class="header-anchor" href="#二、code-splitting-的三种主要方式" aria-label="Permalink to “二、Code Splitting 的三种主要方式”">​</a></h3><h4 id="_1-入口起点-entry-points-——-手动分割" tabindex="-1">1. <strong>入口起点（Entry Points）</strong> —— 手动分割 <a class="header-anchor" href="#_1-入口起点-entry-points-——-手动分割" aria-label="Permalink to “1. 入口起点（Entry Points） —— 手动分割”">​</a></h4><ul><li><strong>原理</strong>：配置多个 <code>entry</code>，生成多个 bundle。</li><li><strong>缺点</strong>：无法自动提取公共依赖，易导致重复代码。</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  entry: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    app: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/app.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vendor: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/vendor.js&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 手动分离第三方库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="_2-splitchunksplugin-推荐-——-自动分割" tabindex="-1">2. <strong>SplitChunksPlugin（推荐）</strong> —— 自动分割 <a class="header-anchor" href="#_2-splitchunksplugin-推荐-——-自动分割" aria-label="Permalink to “2. SplitChunksPlugin（推荐） —— 自动分割”">​</a></h4><ul><li><strong>原理</strong>：Webpack 5 内置插件，<strong>自动提取公共代码</strong>（如 node_modules）。</li><li><strong>默认行为</strong>（<code>optimization.splitChunks</code>）： <ul><li>分离 <code>node_modules</code> 中的代码；</li><li>大于 20KB 的 chunk；</li><li>并行请求 ≤ 30 个。</li></ul></li><li><strong>自定义配置</strong>：</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  optimization: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    splitChunks: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      chunks: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 对所有 chunk 生效（async / initial）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      cacheGroups: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 提取第三方库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        vendor: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/]</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">node_modules</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vendors&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          chunks: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 提取公共业务代码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        common: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          minChunks: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 被至少 2 个 chunk 引用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;common&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          chunks: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>💡 <strong>结果</strong>：生成 <code>app.js</code> + <code>vendors.js</code> + <code>common.js</code>，避免重复打包。</p></blockquote><h4 id="_3-动态导入-dynamic-imports-——-按需加载" tabindex="-1">3. <strong>动态导入（Dynamic Imports）</strong> —— 按需加载 <a class="header-anchor" href="#_3-动态导入-dynamic-imports-——-按需加载" aria-label="Permalink to “3. 动态导入（Dynamic Imports） —— 按需加载”">​</a></h4><ul><li><strong>原理</strong>：使用 <code>import()</code> 语法（符合 ECMAScript 提案），<strong>运行时动态加载模块</strong>。</li><li><strong>适用场景</strong>： <ul><li>路由懒加载（React/Vue）；</li><li>功能性组件（如“导出为 PDF”按钮点击后加载库）。</li></ul></li><li><strong>示例</strong>：</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 路由懒加载（React）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lazy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./Home&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> About</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lazy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./About&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 功能性模块</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;btn&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;click&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exportPDF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./pdfUtils&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  exportPDF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><blockquote><p>✅ <strong>Webpack 自动为每个 <code>import()</code> 创建独立 chunk</strong>，命名默认为 <code>[id].[contenthash].js</code>。</p></blockquote><hr><h3 id="三、实际效果对比" tabindex="-1">三、实际效果对比 <a class="header-anchor" href="#三、实际效果对比" aria-label="Permalink to “三、实际效果对比”">​</a></h3><table tabindex="0"><thead><tr><th>方案</th><th>初始加载体积</th><th>首屏速度</th><th>缓存效率</th></tr></thead><tbody><tr><td>单 Bundle</td><td>2.0 MB</td><td>慢</td><td>低（任何改动全失效）</td></tr><tr><td>Code Splitting</td><td>400 KB (首屏) + 按需加载</td><td>快</td><td>高（vendors.js 长期缓存）</td></tr></tbody></table><hr><h3 id="四、最佳实践" tabindex="-1">四、最佳实践 <a class="header-anchor" href="#四、最佳实践" aria-label="Permalink to “四、最佳实践”">​</a></h3><ol><li><p><strong>优先使用 <code>SplitChunksPlugin</code></strong><br> → 自动优化公共代码，无需手动维护。</p></li><li><p><strong>路由级懒加载</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Vue 3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./views/Home.vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React + Suspense</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Profile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lazy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./Profile&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div></li><li><p><strong>避免过度分割</strong></p><ul><li>过多小 chunk 会增加 HTTP 请求（HTTP/1.1 下影响大，HTTP/2 影响小）；</li><li>Webpack 默认限制：最小 chunk 20KB，最多并行请求 30 个。</li></ul></li><li><p><strong>预加载关键资源（可选）</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 预加载（浏览器空闲时加载）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* webpackPreload: true */</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./critical-component&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div></li></ol><hr><h3 id="五、一句话总结-1" tabindex="-1">五、一句话总结 <a class="header-anchor" href="#五、一句话总结-1" aria-label="Permalink to “五、一句话总结”">​</a></h3><blockquote><p><strong>Code Splitting 通过“拆包 + 按需加载”，让应用首屏更快、缓存更高效——它是现代前端性能优化的基石技术。</strong></p></blockquote><h2 id="webpack的source-map是什么-如何配置生成source-map" tabindex="-1">Webpack的Source Map是什么？如何配置生成Source Map？ <a class="header-anchor" href="#webpack的source-map是什么-如何配置生成source-map" aria-label="Permalink to “Webpack的Source Map是什么？如何配置生成Source Map？”">​</a></h2><p><strong>Source Map（源映射）</strong> 是 Webpack 提供的一种调试工具，用于将<strong>压缩/编译后的代码</strong>（如 bundle.js）<strong>映射回原始源代码</strong>（如 src/index.js），使开发者能在浏览器中直接调试未压缩、未转换的源码。</p><hr><h3 id="一、为什么需要-source-map" tabindex="-1">一、为什么需要 Source Map？ <a class="header-anchor" href="#一、为什么需要-source-map" aria-label="Permalink to “一、为什么需要 Source Map？”">​</a></h3><ul><li><strong>问题</strong>：Webpack 打包后代码被压缩、混淆、合并（如 ES6 → ES5、TypeScript → JS），错误堆栈难以定位；</li><li><strong>解决方案</strong>：Source Map 生成一个 <code>.map</code> 文件，记录<strong>转换后代码 ↔ 原始代码</strong>的映射关系；</li><li><strong>效果</strong>：在浏览器 DevTools 中： <ul><li>断点可打在原始 <code>.ts</code>/<code>.jsx</code> 文件上；</li><li>错误堆栈显示原始文件行号。</li></ul></li></ul><blockquote><p>✅ <strong>核心价值</strong>：提升开发调试效率，尤其在生产环境排查问题时至关重要。</p></blockquote><hr><h3 id="二、如何配置-source-map" tabindex="-1">二、如何配置 Source Map？ <a class="header-anchor" href="#二、如何配置-source-map" aria-label="Permalink to “二、如何配置 Source Map？”">​</a></h3><p>通过 <code>devtool</code> 配置项控制生成方式（<strong>不同值影响构建速度 &amp; 调试体验</strong>）：</p><h4 id="_1-开发环境推荐" tabindex="-1">1. <strong>开发环境推荐</strong> <a class="header-anchor" href="#_1-开发环境推荐" aria-label="Permalink to “1. 开发环境推荐”">​</a></h4><table tabindex="0"><thead><tr><th>配置值</th><th>特点</th><th>适用场景</th></tr></thead><tbody><tr><td><code>&#39;eval&#39;</code></td><td>每个模块用 <code>eval()</code> 执行，最快但功能弱</td><td>快速迭代（不支持列映射）</td></tr><tr><td><code>&#39;cheap-module-eval-source-map&#39;</code></td><td><strong>最佳平衡</strong>：包含 loader 转换前的源码，较快</td><td>React/Vue 开发</td></tr><tr><td><code>&#39;eval-cheap-module-source-map&#39;</code></td><td>同上，但仅行映射（无列映射）</td><td>对速度要求极高</td></tr></tbody></table><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js (开发环境)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;development&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  devtool: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cheap-module-eval-source-map&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 推荐</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="_2-生产环境推荐" tabindex="-1">2. <strong>生产环境推荐</strong> <a class="header-anchor" href="#_2-生产环境推荐" aria-label="Permalink to “2. 生产环境推荐”">​</a></h4><table tabindex="0"><thead><tr><th>配置值</th><th>特点</th><th>适用场景</th></tr></thead><tbody><tr><td><code>&#39;source-map&#39;</code></td><td>生成独立 <code>.map</code> 文件，最完整但最慢</td><td>需要精确错误追踪</td></tr><tr><td><code>&#39;hidden-source-map&#39;</code></td><td>生成 <code>.map</code> 但不关联 bundle（需手动加载）</td><td>安全敏感项目</td></tr><tr><td><strong>不生成</strong></td><td>无 <code>.map</code> 文件</td><td>追求极致体积（不推荐）</td></tr></tbody></table><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js (生产环境)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;production&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  devtool: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;source-map&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 推荐（配合错误监控系统）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>⚠️ <strong>生产环境注意</strong>：</p><ul><li>避免使用 <code>inline</code>（如 <code>inline-source-map</code>），会增大 bundle 体积；</li><li>敏感项目可上传 <code>.map</code> 到私有服务器，不公开暴露。</li></ul></blockquote><hr><h3 id="三、source-map-类型详解" tabindex="-1">三、Source Map 类型详解 <a class="header-anchor" href="#三、source-map-类型详解" aria-label="Permalink to “三、Source Map 类型详解”">​</a></h3><table tabindex="0"><thead><tr><th>配置值</th><th>是否生成 <code>.map</code> 文件</th><th>是否内联到 bundle</th><th>包含 loader 转换前源码</th><th>性能</th></tr></thead><tbody><tr><td><code>eval</code></td><td>❌</td><td>✅（<code>eval</code> 中）</td><td>❌</td><td>⚡️ 极快</td></tr><tr><td><code>cheap-source-map</code></td><td>✅</td><td>❌</td><td>❌</td><td>快</td></tr><tr><td><code>cheap-module-source-map</code></td><td>✅</td><td>❌</td><td>✅</td><td>中</td></tr><tr><td><code>source-map</code></td><td>✅</td><td>❌</td><td>✅</td><td>🐢 慢</td></tr><tr><td><code>inline-source-map</code></td><td>❌</td><td>✅（Base64）</td><td>✅</td><td>慢 + 增大体积</td></tr></tbody></table><blockquote><p>🔑 <strong>关键术语</strong>：</p><ul><li><strong><code>cheap</code></strong>：只映射<strong>行号</strong>（无列号），速度更快；</li><li><strong><code>module</code></strong>：包含 <strong>loader 转换前的源码</strong>（如 TypeScript/JSX 原始代码）；</li><li><strong><code>eval</code></strong>：用 <code>eval()</code> 执行代码，附加 <code>//# sourceURL</code> 实现映射。</li></ul></blockquote><hr><h3 id="四、实际效果演示" tabindex="-1">四、实际效果演示 <a class="header-anchor" href="#四、实际效果演示" aria-label="Permalink to “四、实际效果演示”">​</a></h3><h4 id="_1-未启用-source-map" tabindex="-1">1. <strong>未启用 Source Map</strong> <a class="header-anchor" href="#_1-未启用-source-map" aria-label="Permalink to “1. 未启用 Source Map”">​</a></h4><ul><li>错误堆栈：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bundle.js:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Uncaught </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ReferenceError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: x is not defined</span></span></code></pre></div></li><li>DevTools 只能查看压缩后的 <code>bundle.js</code>。</li></ul><h4 id="_2-启用-source-map-后" tabindex="-1">2. <strong>启用 Source Map 后</strong> <a class="header-anchor" href="#_2-启用-source-map-后" aria-label="Permalink to “2. 启用 Source Map 后”">​</a></h4><ul><li>错误堆栈：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">src</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">utils.js:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Uncaught </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ReferenceError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: x is not defined</span></span></code></pre></div></li><li>DevTools 直接显示 <code>src/utils.js</code> 原始代码，可打断点调试。</li></ul><hr><h3 id="五、高级配置-按需生成" tabindex="-1">五、高级配置（按需生成） <a class="header-anchor" href="#五、高级配置-按需生成" aria-label="Permalink to “五、高级配置（按需生成）”">​</a></h3><h4 id="_1-仅对特定文件生成-source-map" tabindex="-1">1. <strong>仅对特定文件生成 Source Map</strong> <a class="header-anchor" href="#_1-仅对特定文件生成-source-map" aria-label="Permalink to “1. 仅对特定文件生成 Source Map”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 在 loader 中覆盖全局 devtool</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">js</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        use: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            loader: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;babel-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            options: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              sourceMaps: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 强制 Babel 生成 Source Map</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="_2-nginx-配置生产环境-source-map" tabindex="-1">2. <strong>Nginx 配置生产环境 Source Map</strong> <a class="header-anchor" href="#_2-nginx-配置生产环境-source-map" aria-label="Permalink to “2. Nginx 配置生产环境 Source Map”">​</a></h4><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 仅允许内部 IP 访问 .map 文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> \.map$ </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  allow </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">192.168.0.0/16;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  deny </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h3 id="六、一句话总结-3" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-3" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>Source Map 是开发者的“时光机”——它让压缩混淆的生产代码“还原”为可读的源码。开发环境用 <code>cheap-module-eval-source-map</code> 平衡速度与体验，生产环境用 <code>source-map</code> 精准定位错误。</strong></p></blockquote><h2 id="webpack的tree-shaking原理" tabindex="-1">Webpack的Tree Shaking原理 <a class="header-anchor" href="#webpack的tree-shaking原理" aria-label="Permalink to “Webpack的Tree Shaking原理”">​</a></h2><p><strong>Tree Shaking（摇树优化）</strong> 是 Webpack 提供的一种<strong>死代码消除（Dead Code Elimination）</strong> 技术，用于在构建过程中<strong>自动移除未被使用的 JavaScript 代码</strong>，从而减小最终 bundle 体积。它的名字来源于“摇晃一棵树，枯叶（无用代码）自然掉落”。</p><hr><h3 id="一、核心前提-必须使用-es-module-esm" tabindex="-1">一、核心前提：必须使用 ES Module（ESM） <a class="header-anchor" href="#一、核心前提-必须使用-es-module-esm" aria-label="Permalink to “一、核心前提：必须使用 ES Module（ESM）”">​</a></h3><p>Tree Shaking <strong>仅对 ES6 模块（<code>import</code>/<code>export</code>）生效</strong>，原因如下：</p><table tabindex="0"><thead><tr><th>模块系统</th><th>特性</th><th>是否支持 Tree Shaking</th></tr></thead><tbody><tr><td><strong>ES Module (ESM)</strong></td><td>静态结构（编译时确定依赖）</td><td>✅ 支持</td></tr><tr><td>CommonJS (<code>require</code>)</td><td>动态结构（运行时确定依赖）</td><td>❌ 不支持</td></tr></tbody></table><blockquote><p>💡 <strong>关键区别</strong>：</p><ul><li>ESM 的 <code>import</code> 必须在顶层静态声明，Webpack 能在<strong>编译时分析依赖关系</strong>；</li><li>CommonJS 的 <code>require()</code> 可在函数内动态调用，Webpack 无法确定是否会被执行。</li></ul></blockquote><h4 id="示例-可被-tree-shaking-的代码" tabindex="-1">示例：可被 Tree Shaking 的代码 <a class="header-anchor" href="#示例-可被-tree-shaking-的代码" aria-label="Permalink to “示例：可被 Tree Shaking 的代码”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// math.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> multiply</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// index.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { add } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./math.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 只引入 add</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// multiply 会被移除！</span></span></code></pre></div><h4 id="反例-无法-tree-shaking" tabindex="-1">反例：无法 Tree Shaking <a class="header-anchor" href="#反例-无法-tree-shaking" aria-label="Permalink to “反例：无法 Tree Shaking”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 使用 CommonJS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./math.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Webpack 无法确定是否用到 multiply</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 动态导入</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (condition) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./math.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 运行时加载，无法分析</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h3 id="二、tree-shaking-工作原理-webpack-5" tabindex="-1">二、Tree Shaking 工作原理（Webpack 5） <a class="header-anchor" href="#二、tree-shaking-工作原理-webpack-5" aria-label="Permalink to “二、Tree Shaking 工作原理（Webpack 5）”">​</a></h3><h4 id="步骤-1-构建模块依赖图-module-graph" tabindex="-1">步骤 1：构建模块依赖图（Module Graph） <a class="header-anchor" href="#步骤-1-构建模块依赖图-module-graph" aria-label="Permalink to “步骤 1：构建模块依赖图（Module Graph）”">​</a></h4><ul><li>Webpack 解析所有 <code>import</code>/<code>export</code>，建立模块间的引用关系；</li><li>标记每个导出项（如 <code>add</code>, <code>multiply</code>）的<strong>使用情况</strong>。</li></ul><h4 id="步骤-2-标记未使用导出-unused-exports" tabindex="-1">步骤 2：标记未使用导出（Unused Exports） <a class="header-anchor" href="#步骤-2-标记未使用导出-unused-exports" aria-label="Permalink to “步骤 2：标记未使用导出（Unused Exports）”">​</a></h4><ul><li>从入口文件开始，递归遍历所有<strong>被引用的导出</strong>；</li><li>未被任何模块引用的导出标记为 <strong>&quot;unused harmony export&quot;</strong>。</li></ul><h4 id="步骤-3-压缩阶段移除死代码" tabindex="-1">步骤 3：压缩阶段移除死代码 <a class="header-anchor" href="#步骤-3-压缩阶段移除死代码" aria-label="Permalink to “步骤 3：压缩阶段移除死代码”">​</a></h4><ul><li>Webpack 本身只做<strong>标记</strong>，实际删除由 <strong>Terser（JS 压缩器）</strong> 完成；</li><li>Terser 根据标记移除未使用的函数/变量。</li></ul><blockquote><p>🔑 <strong>关键点</strong>：</p><ul><li>Webpack 负责<strong>依赖分析</strong>；</li><li>Terser 负责<strong>代码删除</strong>（需启用 <code>minimize: true</code>）。</li></ul></blockquote><hr><h3 id="三、如何确保-tree-shaking-生效" tabindex="-1">三、如何确保 Tree Shaking 生效？ <a class="header-anchor" href="#三、如何确保-tree-shaking-生效" aria-label="Permalink to “三、如何确保 Tree Shaking 生效？”">​</a></h3><h4 id="_1-使用-es6-模块语法" tabindex="-1">1. <strong>使用 ES6 模块语法</strong> <a class="header-anchor" href="#_1-使用-es6-模块语法" aria-label="Permalink to “1. 使用 ES6 模块语法”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ 正确</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { debounce } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;lodash-es&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 注意是 lodash-es！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ 错误（CommonJS）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">debounce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;lodash&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><blockquote><p>⚠️ <strong>第三方库注意</strong>：</p><ul><li>优先选择提供 ESM 版本的库（如 <code>lodash-es</code> 而非 <code>lodash</code>）；</li><li>若库只有 CommonJS，可通过 <code>babel-plugin-transform-imports</code> 转换。</li></ul></blockquote><h4 id="_2-避免副作用-side-effects" tabindex="-1">2. <strong>避免副作用（Side Effects）</strong> <a class="header-anchor" href="#_2-避免副作用-side-effects" aria-label="Permalink to “2. 避免副作用（Side Effects）”">​</a></h4><ul><li>如果模块有<strong>副作用</strong>（如直接修改全局变量），Webpack 会保守保留整个模块；</li><li><strong>解决方案</strong>：在 <code>package.json</code> 中声明无副作用：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my-lib&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sideEffects&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>或指定有副作用的文件：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sideEffects&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;./src/polyfill.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 保留此文件</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;*.css&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              // 保留 CSS 文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_3-生产模式自动启用" tabindex="-1">3. <strong>生产模式自动启用</strong> <a class="header-anchor" href="#_3-生产模式自动启用" aria-label="Permalink to “3. 生产模式自动启用”">​</a></h4><ul><li>Webpack 的 <code>mode: &#39;production&#39;</code> 会自动： <ul><li>启用 <code>optimization.usedExports</code>（标记未使用导出）；</li><li>启用 Terser 压缩（删除死代码）。</li></ul></li></ul><blockquote><p>✅ <strong>无需额外配置</strong>，但需确保代码符合 ESM 规范。</p></blockquote><hr><h3 id="四、验证-tree-shaking-是否生效" tabindex="-1">四、验证 Tree Shaking 是否生效 <a class="header-anchor" href="#四、验证-tree-shaking-是否生效" aria-label="Permalink to “四、验证 Tree Shaking 是否生效”">​</a></h3><h4 id="方法-1-查看打包后的代码" tabindex="-1">方法 1：查看打包后的代码 <a class="header-anchor" href="#方法-1-查看打包后的代码" aria-label="Permalink to “方法 1：查看打包后的代码”">​</a></h4><ul><li>未被使用的函数<strong>完全消失</strong>（而非注释掉）。</li></ul><h4 id="方法-2-使用-webpack-bundle-analyzer" tabindex="-1">方法 2：使用 <code>webpack-bundle-analyzer</code> <a class="header-anchor" href="#方法-2-使用-webpack-bundle-analyzer" aria-label="Permalink to “方法 2：使用 webpack-bundle-analyzer”">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> webpack-bundle-analyzer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist/main.js</span></span></code></pre></div><ul><li>对比开启/关闭 Tree Shaking 的 bundle 体积。</li></ul><h4 id="方法-3-webpack-日志" tabindex="-1">方法 3：Webpack 日志 <a class="header-anchor" href="#方法-3-webpack-日志" aria-label="Permalink to “方法 3：Webpack 日志”">​</a></h4><ul><li>添加 <code>--stats-verbose</code> 查看标记信息：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">webpack</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mode=production</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --stats-verbose</span></span></code></pre></div>输出示例：<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>[./src/math.js] 120 bytes {0} [built]</span></span>
<span class="line"><span>    harmony export [used] add</span></span>
<span class="line"><span>    harmony export [unused] multiply  // ← 明确标记 unused</span></span></code></pre></div></li></ul><hr><h3 id="五、常见陷阱与解决方案" tabindex="-1">五、常见陷阱与解决方案 <a class="header-anchor" href="#五、常见陷阱与解决方案" aria-label="Permalink to “五、常见陷阱与解决方案”">​</a></h3><table tabindex="0"><thead><tr><th>问题</th><th>原因</th><th>解决方案</th></tr></thead><tbody><tr><td><strong>整个库被打包</strong></td><td>库使用 CommonJS</td><td>改用 ESM 版本（如 <code>lodash-es</code>）</td></tr><tr><td><strong>未使用函数仍存在</strong></td><td>模块有副作用</td><td>在 <code>package.json</code> 设置 <code>&quot;sideEffects&quot;: false</code></td></tr><tr><td><strong>开发环境未生效</strong></td><td>未压缩代码</td><td>Tree Shaking 仅在生产模式生效（需 Terser）</td></tr><tr><td><strong>动态访问导出</strong></td><td><code>obj[methodName]()</code></td><td>避免动态调用，改用静态引用</td></tr></tbody></table><hr><h3 id="六、一句话总结-4" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-4" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>Tree Shaking 依赖 ES Module 的静态分析能力，在生产构建中自动移除未引用的代码——它是现代前端应用“瘦身”的关键技术，但需开发者规范使用 ESM 并声明无副作用。</strong></p></blockquote><h2 id="如何提高webpack的打包速度" tabindex="-1">如何提高webpack的打包速度 <a class="header-anchor" href="#如何提高webpack的打包速度" aria-label="Permalink to “如何提高webpack的打包速度”">​</a></h2><p>提高 Webpack 打包速度是前端工程化中的核心优化点。以下从 <strong>配置优化、工具升级、缓存策略、架构调整</strong> 四个维度，提供 <strong>10+ 项实战有效的提速方案</strong>（基于 Webpack 5）：</p><hr><h3 id="一、基础配置优化-立竿见影" tabindex="-1">一、基础配置优化（立竿见影） <a class="header-anchor" href="#一、基础配置优化-立竿见影" aria-label="Permalink to “一、基础配置优化（立竿见影）”">​</a></h3><h4 id="_1-升级到-webpack-5-node-js-16" tabindex="-1">1. <strong>升级到 Webpack 5 + Node.js 16+</strong> <a class="header-anchor" href="#_1-升级到-webpack-5-node-js-16" aria-label="Permalink to “1. 升级到 Webpack 5 + Node.js 16+”">​</a></h4><ul><li>Webpack 5 内置： <ul><li><strong>持久化缓存</strong>（<code>cache: { type: &#39;filesystem&#39; }</code>）；</li><li><strong>更好的 Tree Shaking</strong>；</li><li><strong>Asset Modules</strong> 替代 <code>file-loader</code> 等。</li></ul></li><li>Node.js 16+ V8 引擎性能提升显著。</li></ul><h4 id="_2-启用持久化缓存" tabindex="-1">2. <strong>启用持久化缓存</strong> <a class="header-anchor" href="#_2-启用持久化缓存" aria-label="Permalink to “2. 启用持久化缓存”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cache: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;filesystem&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 将缓存存储到 node_modules/.cache/webpack</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    buildDependencies: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      config: [__filename] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 配置变更时失效缓存</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>✅ <strong>效果</strong>：二次构建速度提升 <strong>50%~90%</strong>（尤其大型项目）。</p></blockquote><h4 id="_3-缩小文件搜索范围" tabindex="-1">3. <strong>缩小文件搜索范围</strong> <a class="header-anchor" href="#_3-缩小文件搜索范围" aria-label="Permalink to “3. 缩小文件搜索范围”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  resolve: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    modules: [path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;src&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;node_modules&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 优先查 src</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    extensions: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.jsx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 减少后缀尝试</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">js</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        include: path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;src&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 只编译 src</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        exclude:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">node_modules</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 跳过 node_modules</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="_4-使用更快的-source-map-开发环境" tabindex="-1">4. <strong>使用更快的 Source Map（开发环境）</strong> <a class="header-anchor" href="#_4-使用更快的-source-map-开发环境" aria-label="Permalink to “4. 使用更快的 Source Map（开发环境）”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 开发环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">devtool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;eval-cheap-module-source-map&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 比 source-map 快 60%</span></span></code></pre></div><hr><h3 id="二、loader-与-plugin-优化" tabindex="-1">二、Loader 与 Plugin 优化 <a class="header-anchor" href="#二、loader-与-plugin-优化" aria-label="Permalink to “二、Loader 与 Plugin 优化”">​</a></h3><h4 id="_5-多进程处理-js-thread-loader" tabindex="-1">5. <strong>多进程处理 JS（Thread Loader）</strong> <a class="header-anchor" href="#_5-多进程处理-js-thread-loader" aria-label="Permalink to “5. 多进程处理 JS（Thread Loader）”">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thread-loader</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">js</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        use: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          &#39;thread-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 开启多进程</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          &#39;babel-loader&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>⚠️ <strong>注意</strong>：小项目可能因进程开销反而变慢，建议 &gt; 50 个文件再启用。</p></blockquote><h4 id="_6-优化-babel-编译" tabindex="-1">6. <strong>优化 Babel 编译</strong> <a class="header-anchor" href="#_6-优化-babel-编译" aria-label="Permalink to “6. 优化 Babel 编译”">​</a></h4><ul><li><strong>仅编译必要代码</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// babel.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  presets: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@babel/preset-env&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      targets: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&gt; 0.25%, not dead&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 按需 polyfill</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      useBuiltIns: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;usage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      corejs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></li><li><strong>启用缓存</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  loader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;babel-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cacheDirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 缓存编译结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_7-避免重复-plugin" tabindex="-1">7. <strong>避免重复 Plugin</strong> <a class="header-anchor" href="#_7-避免重复-plugin" aria-label="Permalink to “7. 避免重复 Plugin”">​</a></h4><ul><li>移除 <code>HotModuleReplacementPlugin</code>（Webpack 5 Dev Server 已内置）；</li><li>合并功能重叠的插件（如 <code>MiniCssExtractPlugin</code> 已包含 CSS 提取）。</li></ul><hr><h3 id="三、高级优化策略" tabindex="-1">三、高级优化策略 <a class="header-anchor" href="#三、高级优化策略" aria-label="Permalink to “三、高级优化策略”">​</a></h3><h4 id="_8-dll-动态链接库-预构建-适用于稳定依赖" tabindex="-1">8. <strong>DLL（动态链接库）预构建（适用于稳定依赖）</strong> <a class="header-anchor" href="#_8-dll-动态链接库-预构建-适用于稳定依赖" aria-label="Permalink to “8. DLL（动态链接库）预构建（适用于稳定依赖）”">​</a></h4><ul><li><strong>原理</strong>：将 <code>react</code>, <code>lodash</code> 等不常变动的库<strong>提前打包</strong>，后续构建跳过。</li><li><strong>步骤</strong>： <ol><li>创建 <code>webpack.dll.js</code> 预构建 vendor；</li><li>主配置通过 <code>DllReferencePlugin</code> 引用。</li></ol></li><li><strong>效果</strong>：大型项目构建时间减少 <strong>30%~50%</strong>。</li></ul><blockquote><p>💡 <strong>现代替代方案</strong>：Webpack 5 的 <code>cache</code> + <code>SplitChunks</code> 已大幅降低 DLL 必要性。</p></blockquote><h4 id="_9-按需加载第三方库" tabindex="-1">9. <strong>按需加载第三方库</strong> <a class="header-anchor" href="#_9-按需加载第三方库" aria-label="Permalink to “9. 按需加载第三方库”">​</a></h4><ul><li><strong>问题</strong>：<code>import _ from &#39;lodash&#39;</code> 会打包整个库；</li><li><strong>解决方案</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 改为按需引入</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> debounce </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;lodash/debounce&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 或使用 babel-plugin-lodash 自动转换</span></span></code></pre></div></li></ul><h4 id="_10-监控与分析" tabindex="-1">10. <strong>监控与分析</strong> <a class="header-anchor" href="#_10-监控与分析" aria-label="Permalink to “10. 监控与分析”">​</a></h4><ul><li><strong>定位瓶颈</strong>：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输出各阶段耗时</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">webpack</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --profile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --json</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stats.json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 可视化分析</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> webpack-bundle-analyzer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stats.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> speed-measure-webpack-plugin</span></span></code></pre></div></li><li><strong>关键指标</strong>： <ul><li><code>resolve</code> 耗时 → 优化 <code>resolve.modules</code>；</li><li><code>build</code> 耗时 → 优化 Loader；</li><li><code>seal</code> 耶时 → 优化 SplitChunks。</li></ul></li></ul><hr><h3 id="四、架构级优化-长期收益" tabindex="-1">四、架构级优化（长期收益） <a class="header-anchor" href="#四、架构级优化-长期收益" aria-label="Permalink to “四、架构级优化（长期收益）”">​</a></h3><table tabindex="0"><thead><tr><th>方案</th><th>说明</th></tr></thead><tbody><tr><td><strong>微前端拆分</strong></td><td>将巨型应用拆分为独立子应用，各自构建</td></tr><tr><td><strong>Monorepo + Nx/Turborepo</strong></td><td>利用任务管道和缓存加速多包项目</td></tr><tr><td><strong>Vite/Rollup 替代</strong></td><td>开发环境用 Vite（ESM 原生加载），生产仍用 Webpack</td></tr></tbody></table><hr><h3 id="五、避坑指南" tabindex="-1">五、避坑指南 <a class="header-anchor" href="#五、避坑指南" aria-label="Permalink to “五、避坑指南”">​</a></h3><ul><li>❌ <strong>不要过度分割 Chunk</strong>：HTTP/2 下过多小文件反而增加调度开销；</li><li>❌ <strong>避免 inline Source Map</strong>：<code>inline-source-map</code> 会增大 bundle 体积；</li><li>✅ <strong>开发/生产配置分离</strong>：用 <code>webpack-merge</code> 拆分配置，避免冗余逻辑。</li></ul><hr><h3 id="六、效果对比-典型项目" tabindex="-1">六、效果对比（典型项目） <a class="header-anchor" href="#六、效果对比-典型项目" aria-label="Permalink to “六、效果对比（典型项目）”">​</a></h3><table tabindex="0"><thead><tr><th>优化前</th><th>优化后</th><th>提升</th></tr></thead><tbody><tr><td>首次构建：45s</td><td>首次构建：30s</td><td>↓ 33%</td></tr><tr><td>二次构建：22s</td><td>二次构建：3s</td><td>↓ 86%</td></tr></tbody></table><hr><h3 id="一句话总结-1" tabindex="-1">一句话总结 <a class="header-anchor" href="#一句话总结-1" aria-label="Permalink to “一句话总结”">​</a></h3><blockquote><p><strong>提速核心 = 缓存（持久化） + 并行（多进程） + 精简（缩小范围） + 监控（精准优化）——优先启用 Webpack 5 缓存，再针对性优化 Loader 和依赖。</strong></p></blockquote><h2 id="如何减少打包后的代码体积" tabindex="-1">如何减少打包后的代码体积 <a class="header-anchor" href="#如何减少打包后的代码体积" aria-label="Permalink to “如何减少打包后的代码体积”">​</a></h2><p>减少 Webpack 打包后的代码体积（Bundle Size）是提升 Web 应用<strong>加载速度、用户体验和 SEO 表现</strong>的关键。以下是 <strong>系统化、可落地的优化策略</strong>，涵盖配置、代码、依赖和架构层面：</p><hr><h3 id="一、启用生产模式-基础但关键" tabindex="-1">一、启用生产模式（基础但关键） <a class="header-anchor" href="#一、启用生产模式-基础但关键" aria-label="Permalink to “一、启用生产模式（基础但关键）”">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;production&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 自动启用：代码压缩、Tree Shaking、作用域提升</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>✅ <strong>效果</strong>：默认开启 Terser 压缩 + 移除 <code>process.env.NODE_ENV !== &#39;production&#39;</code> 的代码。</p></blockquote><hr><h3 id="二、代码分割-code-splitting" tabindex="-1">二、代码分割（Code Splitting） <a class="header-anchor" href="#二、代码分割-code-splitting" aria-label="Permalink to “二、代码分割（Code Splitting）”">​</a></h3><h4 id="_1-自动分割公共代码" tabindex="-1">1. <strong>自动分割公共代码</strong> <a class="header-anchor" href="#_1-自动分割公共代码" aria-label="Permalink to “1. 自动分割公共代码”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  splitChunks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    chunks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    cacheGroups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      vendor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/]</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">node_modules</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vendors&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        chunks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><blockquote><p>✅ <strong>效果</strong>：分离第三方库（如 React），利用长期缓存。</p></blockquote><h4 id="_2-路由-组件懒加载" tabindex="-1">2. <strong>路由/组件懒加载</strong> <a class="header-anchor" href="#_2-路由-组件懒加载" aria-label="Permalink to “2. 路由/组件懒加载”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lazy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./Home&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Vue</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> About</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./About.vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><blockquote><p>✅ <strong>效果</strong>：首屏仅加载必要代码，体积减少 30%~70%。</p></blockquote><hr><h3 id="三、tree-shaking-移除死代码" tabindex="-1">三、Tree Shaking（移除死代码） <a class="header-anchor" href="#三、tree-shaking-移除死代码" aria-label="Permalink to “三、Tree Shaking（移除死代码）”">​</a></h3><h4 id="关键前提" tabindex="-1">关键前提： <a class="header-anchor" href="#关键前提" aria-label="Permalink to “关键前提：”">​</a></h4><ul><li>使用 <strong>ES6 模块</strong>（<code>import</code>/<code>export</code>）；</li><li>第三方库提供 <strong>ESM 版本</strong>（如 <code>lodash-es</code> 而非 <code>lodash</code>）；</li><li>在 <code>package.json</code> 声明无副作用：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;sideEffects&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><blockquote><p>✅ <strong>效果</strong>：未使用的函数/组件彻底从 bundle 中移除。</p></blockquote><hr><h3 id="四、优化第三方依赖" tabindex="-1">四、优化第三方依赖 <a class="header-anchor" href="#四、优化第三方依赖" aria-label="Permalink to “四、优化第三方依赖”">​</a></h3><h4 id="_1-按需引入" tabindex="-1">1. <strong>按需引入</strong> <a class="header-anchor" href="#_1-按需引入" aria-label="Permalink to “1. 按需引入”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ 全量引入（打包整个库）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { debounce } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;lodash&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ 按需引入（仅打包 debounce）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> debounce </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;lodash/debounce&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h4 id="_2-替换轻量级替代品" tabindex="-1">2. <strong>替换轻量级替代品</strong> <a class="header-anchor" href="#_2-替换轻量级替代品" aria-label="Permalink to “2. 替换轻量级替代品”">​</a></h4><table tabindex="0"><thead><tr><th>原库</th><th>轻量替代</th></tr></thead><tbody><tr><td><code>moment.js</code> (70KB)</td><td><code>date-fns</code> (模块化) / <code>dayjs</code> (2KB)</td></tr><tr><td><code>lodash</code> (24KB)</td><td><code>lodash-es</code> + 按需引入 / <code>radash</code></td></tr><tr><td><code>axios</code> (13KB)</td><td>原生 <code>fetch</code> + 封装</td></tr></tbody></table><h4 id="_3-分析依赖体积" tabindex="-1">3. <strong>分析依赖体积</strong> <a class="header-anchor" href="#_3-分析依赖体积" aria-label="Permalink to “3. 分析依赖体积”">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装分析工具</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> webpack-bundle-analyzer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 生成可视化报告</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> webpack-bundle-analyzer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist/main.js</span></span></code></pre></div><blockquote><p>🔍 <strong>定位问题</strong>：发现意外打包的大依赖（如 <code>@babel/polyfill</code>）。</p></blockquote><hr><h3 id="五、资源优化" tabindex="-1">五、资源优化 <a class="header-anchor" href="#五、资源优化" aria-label="Permalink to “五、资源优化”">​</a></h3><h4 id="_1-压缩图片-字体" tabindex="-1">1. <strong>压缩图片/字体</strong> <a class="header-anchor" href="#_1-压缩图片-字体" aria-label="Permalink to “1. 压缩图片/字体”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(png</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">jpg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">svg)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;asset&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        parser: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          dataUrlCondition: { maxSize: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &lt;8KB 转 base64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><blockquote><p>✅ <strong>配合工具</strong>：<code>imagemin-webpack-plugin</code> 进一步压缩图片。</p></blockquote><h4 id="_2-移除未使用-css" tabindex="-1">2. <strong>移除未使用 CSS</strong> <a class="header-anchor" href="#_2-移除未使用-css" aria-label="Permalink to “2. 移除未使用 CSS”">​</a></h4><ul><li>使用 <code>PurgeCSS</code>（配合 <code>mini-css-extract-plugin</code>）：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// postcss.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;purgecss&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      content: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/**/*.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./src/**/*.{js,jsx}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></li></ul><blockquote><p>✅ <strong>效果</strong>：Tailwind CSS 项目体积减少 90%。</p></blockquote><hr><h3 id="六、高级技巧" tabindex="-1">六、高级技巧 <a class="header-anchor" href="#六、高级技巧" aria-label="Permalink to “六、高级技巧”">​</a></h3><h4 id="_1-动态-polyfill" tabindex="-1">1. <strong>动态 Polyfill</strong> <a class="header-anchor" href="#_1-动态-polyfill" aria-label="Permalink to “1. 动态 Polyfill”">​</a></h4><ul><li>避免全量引入 <code>core-js</code>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// babel.config.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">presets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@babel/preset-env&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    useBuiltIns: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;usage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 按需注入 polyfill</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    corejs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li><li>或使用 <a href="https://polyfill.io/" target="_blank" rel="noreferrer">Polyfill.io</a> 按浏览器需求加载。</li></ul><h4 id="_2-gzip-brotli-压缩" tabindex="-1">2. <strong>Gzip/Brotli 压缩</strong> <a class="header-anchor" href="#_2-gzip-brotli-压缩" aria-label="Permalink to “2. Gzip/Brotli 压缩”">​</a></h4><ul><li>Webpack 生成文件后，通过服务器或插件压缩：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CompressionPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;compression-webpack-plugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CompressionPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ algorithm: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;gzip&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li></ul><blockquote><p>✅ <strong>效果</strong>：文本资源体积减少 70%（需 Nginx/Apache 启用 gzip）。</p></blockquote><h4 id="_3-代码拆分-预加载" tabindex="-1">3. <strong>代码拆分 + 预加载</strong> <a class="header-anchor" href="#_3-代码拆分-预加载" aria-label="Permalink to “3. 代码拆分 + 预加载”">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 关键路由预加载（空闲时加载）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Profile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lazy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* webpackPreload: true */</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./Profile&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><hr><h3 id="七、避坑指南" tabindex="-1">七、避坑指南 <a class="header-anchor" href="#七、避坑指南" aria-label="Permalink to “七、避坑指南”">​</a></h3><table tabindex="0"><thead><tr><th>陷阱</th><th>解决方案</th></tr></thead><tbody><tr><td><strong>开发环境未 Tree Shaking</strong></td><td>确保生产构建（<code>mode: &#39;production&#39;</code>）</td></tr><tr><td><strong>CSS 未提取</strong></td><td>用 <code>MiniCssExtractPlugin</code> 替代 <code>style-loader</code></td></tr><tr><td><strong>Source Map 泄露</strong></td><td>生产环境移除 <code>.map</code> 文件或设为 <code>hidden-source-map</code></td></tr><tr><td><strong>重复依赖</strong></td><td>用 <code>npm ls lodash</code> 检查多版本，用 <code>resolutions</code> 锁定</td></tr></tbody></table><hr><h3 id="八、效果验证" tabindex="-1">八、效果验证 <a class="header-anchor" href="#八、效果验证" aria-label="Permalink to “八、效果验证”">​</a></h3><ol><li><strong>量化指标</strong>： <ul><li>首屏 JS 体积 &lt; 200KB（压缩后）；</li><li>Lighthouse Performance Score &gt; 90。</li></ul></li><li><strong>监控工具</strong>： <ul><li>Webpack Bundle Analyzer；</li><li>Chrome DevTools Coverage Tab（检测未执行代码）。</li></ul></li></ol><hr><h3 id="一句话总结-2" tabindex="-1">一句话总结 <a class="header-anchor" href="#一句话总结-2" aria-label="Permalink to “一句话总结”">​</a></h3><blockquote><p><strong>减小 bundle 体积 = 分割（Code Splitting） + 清理（Tree Shaking + PurgeCSS） + 替换（轻量依赖） + 压缩（Terser + Gzip）——先分析，再精准优化。</strong></p></blockquote><h2 id="vite-比-webpack-快在哪里" tabindex="-1">vite 比 webpack 快在哪里 <a class="header-anchor" href="#vite-比-webpack-快在哪里" aria-label="Permalink to “vite 比 webpack 快在哪里”">​</a></h2><p>Vite 之所以比 Webpack <strong>快一个数量级</strong>（尤其在大型项目中），核心在于它<strong>彻底重构了开发服务器的构建模型</strong>，从“打包后运行”变为“按需编译 + 原生 ESM 加载”。以下是关键差异和原理详解：</p><hr><h3 id="一、根本区别-开发模式架构" tabindex="-1">一、根本区别：开发模式架构 <a class="header-anchor" href="#一、根本区别-开发模式架构" aria-label="Permalink to “一、根本区别：开发模式架构”">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th><strong>Webpack (传统)</strong></th><th><strong>Vite (现代)</strong></th></tr></thead><tbody><tr><td><strong>开发服务器启动</strong></td><td>先全量打包 → 再启动服务</td><td><strong>秒级启动</strong>（无需打包）</td></tr><tr><td><strong>模块加载方式</strong></td><td>打包成单个/多个 bundle</td><td><strong>原生浏览器 ESM</strong>（<code>&lt;script type=&quot;module&quot;&gt;</code>）</td></tr><tr><td><strong>代码更新</strong></td><td>整体重编译 + HMR</td><td><strong>按需编译 + 精准 HMR</strong></td></tr><tr><td><strong>依赖处理</strong></td><td>所有代码（含 node_modules）走 Loader</td><td><strong>预构建依赖</strong>（ESM 兼容化）</td></tr></tbody></table><blockquote><p>✅ <strong>Vite 的核心思想</strong>：<br><strong>“开发环境不打包，利用浏览器原生 ESM 能力；仅对源码做按需转换。”</strong></p></blockquote><hr><h3 id="二、vite-快的三大核心技术" tabindex="-1">二、Vite 快的三大核心技术 <a class="header-anchor" href="#二、vite-快的三大核心技术" aria-label="Permalink to “二、Vite 快的三大核心技术”">​</a></h3><h4 id="_1-秒级冷启动-跳过打包" tabindex="-1">1. <strong>秒级冷启动：跳过打包</strong> <a class="header-anchor" href="#_1-秒级冷启动-跳过打包" aria-label="Permalink to “1. 秒级冷启动：跳过打包”">​</a></h4><ul><li><p><strong>Webpack</strong>：<br> 启动时需递归解析所有模块 → 调用 Babel/TypeScript 编译 → 生成 bundle → 启动 Dev Server（大型项目耗时 30s+）。</p></li><li><p><strong>Vite</strong>：</p><ul><li>启动时<strong>只扫描 <code>index.html</code> 和直接依赖</strong>；</li><li>浏览器请求 <code>/src/main.js</code> 时，Vite <strong>实时编译该文件</strong>并返回；</li><li><strong>无全量构建过程</strong> → 启动速度与项目大小<strong>几乎无关</strong>（通常 &lt; 500ms）。</li></ul></li></ul><h4 id="_2-原生-esm-零打包依赖" tabindex="-1">2. <strong>原生 ESM：零打包依赖</strong> <a class="header-anchor" href="#_2-原生-esm-零打包依赖" aria-label="Permalink to “2. 原生 ESM：零打包依赖”">​</a></h4><ul><li><strong>浏览器直接加载</strong>：<div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- Vite 生成的 index.html --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;module&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/src/main.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li>当浏览器遇到 <code>import { foo } from &#39;./utils.js&#39;</code>： <ul><li>自动发起 HTTP 请求 <code>/src/utils.js</code>；</li><li>Vite 拦截请求 → 实时编译 TS/JSX → 返回合法 ESM。</li></ul></li><li><strong>优势</strong>： <ul><li>无需合并模块；</li><li>无作用域提升、模块包装等开销。</li></ul></li></ul><h4 id="_3-智能依赖预构建-pre-bundling" tabindex="-1">3. <strong>智能依赖预构建（Pre-bundling）</strong> <a class="header-anchor" href="#_3-智能依赖预构建-pre-bundling" aria-label="Permalink to “3. 智能依赖预构建（Pre-bundling）”">​</a></h4><ul><li><p><strong>问题</strong>：<br><code>node_modules</code> 中的库多为 CommonJS 或非 ESM 格式，浏览器无法直接运行。</p></li><li><p><strong>Vite 解决方案</strong>：</p><ol><li>启动时用 <strong>esbuild</strong>（Go 编写，比 JS 快 10~100 倍）扫描依赖；</li><li>将 CommonJS / UMD 库转换为 <strong>单个 ESM 文件</strong>（如 <code>vue.js</code> → <code>vue.esm-browser.js</code>）；</li><li>缓存结果（<code>node_modules/.vite/deps</code>），后续启动直接复用。</li></ol></li><li><p><strong>效果</strong>：</p><ul><li>首次启动稍慢（因预构建），但后续启动极快；</li><li>运行时依赖通过单个 HTTP 请求加载（而非数百个）。</li></ul></li></ul><blockquote><p>🔑 <strong>esbuild 的威力</strong>：<br> Vite 用 esbuild 预构建依赖（快），而 Webpack 用 JS 编写的 Babel/Terser 处理所有代码（慢）。</p></blockquote><hr><h3 id="三、hmr-热更新-性能碾压" tabindex="-1">三、HMR（热更新）性能碾压 <a class="header-anchor" href="#三、hmr-热更新-性能碾压" aria-label="Permalink to “三、HMR（热更新）性能碾压”">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>Webpack</th><th>Vite</th></tr></thead><tbody><tr><td><strong>更新一个组件</strong></td><td>1. 重新编译整个依赖链<br>2. 通知客户端重载模块</td><td>1. <strong>仅编译该文件</strong><br>2. 通过 WebSocket 精准更新</td></tr><tr><td><strong>更新时间</strong></td><td>500ms ~ 2s（随项目增大）</td><td><strong>&lt; 50ms</strong>（恒定）</td></tr><tr><td><strong>状态保留</strong></td><td>需框架插件支持</td><td>原生支持（ESM 模块可精确替换）</td></tr></tbody></table><blockquote><p>💡 <strong>原因</strong>：<br> Webpack 的 HMR 需遍历模块依赖图确定影响范围；<br> Vite 直接映射文件路径到浏览器模块，更新路径唯一。</p></blockquote><hr><h3 id="四、生产构建-vite-也不弱" tabindex="-1">四、生产构建：Vite 也不弱 <a class="header-anchor" href="#四、生产构建-vite-也不弱" aria-label="Permalink to “四、生产构建：Vite 也不弱”">​</a></h3><ul><li><strong>开发用 Vite，生产用 Rollup</strong>：<br> Vite 生产构建基于 <strong>Rollup</strong>（更简洁的打包器），默认开启： <ul><li>Code Splitting</li><li>Tree Shaking</li><li>压缩（terser）</li></ul></li><li><strong>结果</strong>：生产包体积与 Webpack 相当，甚至更优（Rollup 的 Tree Shaking 更激进）。</li></ul><hr><h3 id="五、对比总结表" tabindex="-1">五、对比总结表 <a class="header-anchor" href="#五、对比总结表" aria-label="Permalink to “五、对比总结表”">​</a></h3><table tabindex="0"><thead><tr><th>维度</th><th>Webpack</th><th>Vite</th></tr></thead><tbody><tr><td><strong>开发启动速度</strong></td><td>慢（O(n)）</td><td>极快（O(1)）</td></tr><tr><td><strong>HMR 速度</strong></td><td>随项目增大变慢</td><td>恒定快速</td></tr><tr><td><strong>配置复杂度</strong></td><td>高（Loader/Plugin 体系）</td><td>低（约定优于配置）</td></tr><tr><td><strong>适用场景</strong></td><td>复杂定制需求、旧项目</td><td>新项目、追求开发体验</td></tr><tr><td><strong>生态</strong></td><td>插件丰富（10年积累）</td><td>快速追赶（兼容 Rollup 插件）</td></tr></tbody></table><hr><h3 id="六、何时仍选-webpack" tabindex="-1">六、何时仍选 Webpack？ <a class="header-anchor" href="#六、何时仍选-webpack" aria-label="Permalink to “六、何时仍选 Webpack？”">​</a></h3><ul><li>需要深度定制构建流程（如微前端沙箱）；</li><li>项目重度依赖 Webpack 特有插件（如 <code>Module Federation</code>）；</li><li>必须支持 IE11（Vite 不支持）。</li></ul><hr><h3 id="一句话总结-3" tabindex="-1">一句话总结 <a class="header-anchor" href="#一句话总结-3" aria-label="Permalink to “一句话总结”">​</a></h3><blockquote><p><strong>Vite 快在“不打包”——利用浏览器原生 ESM 能力，按需编译源码 + esbuild 预构建依赖，彻底绕过传统打包器的性能瓶颈。</strong></p></blockquote><h2 id="说一下你对-monorepo-的理解" tabindex="-1">说一下你对 Monorepo 的理解 <a class="header-anchor" href="#说一下你对-monorepo-的理解" aria-label="Permalink to “说一下你对 Monorepo 的理解”">​</a></h2><p><strong>Monorepo（单体仓库）</strong> 是一种软件开发的源码管理策略：<strong>将多个相关项目（如多个包、应用、服务）放在同一个代码仓库中进行统一管理</strong>，而不是为每个项目单独创建一个仓库（即 Multirepo / Polyrepo）。</p><hr><h3 id="一、核心思想" tabindex="-1">一、核心思想 <a class="header-anchor" href="#一、核心思想" aria-label="Permalink to “一、核心思想”">​</a></h3><blockquote><p><strong>“逻辑分离，物理集中”</strong><br> 虽然代码在同一个 Git 仓库里，但通过工具和规范保持各子项目的<strong>独立性、可复用性和可发布性</strong>。</p></blockquote><h4 id="典型结构示例" tabindex="-1">典型结构示例： <a class="header-anchor" href="#典型结构示例" aria-label="Permalink to “典型结构示例：”">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">my-monorepo/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packages/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shared-utils/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 共享工具库（可独立发布）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ui-components/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # React 组件库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> web-app/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 主 Web 应用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mobile-app/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # React Native 应用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tools/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 构建/部署脚本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pnpm-workspace.yaml</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 或 lerna.json, nx.json</span></span></code></pre></div><hr><h3 id="二、monorepo-的核心优势" tabindex="-1">二、Monorepo 的核心优势 <a class="header-anchor" href="#二、monorepo-的核心优势" aria-label="Permalink to “二、Monorepo 的核心优势”">​</a></h3><h4 id="✅-1-跨项目协作更高效" tabindex="-1">✅ 1. <strong>跨项目协作更高效</strong> <a class="header-anchor" href="#✅-1-跨项目协作更高效" aria-label="Permalink to “✅ 1. 跨项目协作更高效”">​</a></h4><ul><li>修改 <code>shared-utils</code> 后，<strong>立即在 <code>web-app</code> 和 <code>mobile-app</code> 中验证效果</strong>；</li><li>避免 Multirepo 中“改 A → 发版 → 升级 B → 测试 → 发现问题 → 回滚”的繁琐流程。</li></ul><h4 id="✅-2-原子化提交-atomic-commits" tabindex="-1">✅ 2. <strong>原子化提交（Atomic Commits）</strong> <a class="header-anchor" href="#✅-2-原子化提交-atomic-commits" aria-label="Permalink to “✅ 2. 原子化提交（Atomic Commits）”">​</a></h4><ul><li>一次提交可同时修改多个包（如接口变更 + 前端调用 + 后端实现）；</li><li>保证系统整体一致性，避免版本错配。</li></ul><h4 id="✅-3-统一技术栈与规范" tabindex="-1">✅ 3. <strong>统一技术栈与规范</strong> <a class="header-anchor" href="#✅-3-统一技术栈与规范" aria-label="Permalink to “✅ 3. 统一技术栈与规范”">​</a></h4><ul><li>共享 ESLint、TypeScript、Babel、测试配置；</li><li>强制代码风格、依赖版本一致（通过 <code>pnpm overrides</code> 或 <code>yarn resolutions</code>）。</li></ul><h4 id="✅-4-依赖管理优化" tabindex="-1">✅ 4. <strong>依赖管理优化</strong> <a class="header-anchor" href="#✅-4-依赖管理优化" aria-label="Permalink to “✅ 4. 依赖管理优化”">​</a></h4><ul><li><strong>单一 <code>node_modules</code></strong>（使用 pnpm / Yarn Workspaces）： <ul><li>减少磁盘占用（相同依赖只安装一次）；</li><li>消除“依赖地狱”（不同包依赖同一库的不同版本）。</li></ul></li></ul><h4 id="✅-5-简化-ci-cd-与自动化" tabindex="-1">✅ 5. <strong>简化 CI/CD 与自动化</strong> <a class="header-anchor" href="#✅-5-简化-ci-cd-与自动化" aria-label="Permalink to “✅ 5. 简化 CI/CD 与自动化”">​</a></h4><ul><li>一次 PR 可触发所有受影响项目的测试；</li><li>工具（如 Nx、Turborepo）能<strong>智能计算影响范围</strong>，只构建/测试变更相关的包。</li></ul><hr><h3 id="三、monorepo-的挑战与应对" tabindex="-1">三、Monorepo 的挑战与应对 <a class="header-anchor" href="#三、monorepo-的挑战与应对" aria-label="Permalink to “三、Monorepo 的挑战与应对”">​</a></h3><table tabindex="0"><thead><tr><th>挑战</th><th>解决方案</th></tr></thead><tbody><tr><td><strong>仓库体积膨胀</strong></td><td>使用 <code>.gitignore</code> + 工具（如 Nx）按需克隆</td></tr><tr><td><strong>权限控制困难</strong></td><td>Git 子目录权限（GitHub CODEOWNERS）</td></tr><tr><td><strong>构建/测试变慢</strong></td><td><strong>增量构建</strong>（Nx/Turborepo 缓存）</td></tr><tr><td><strong>发布流程复杂</strong></td><td>自动化语义化发布（Changesets, Lerna）</td></tr><tr><td><strong>团队认知负担</strong></td><td>清晰文档 + 目录规范 + 工具脚手架</td></tr></tbody></table><hr><h3 id="四、主流-monorepo-工具对比" tabindex="-1">四、主流 Monorepo 工具对比 <a class="header-anchor" href="#四、主流-monorepo-工具对比" aria-label="Permalink to “四、主流 Monorepo 工具对比”">​</a></h3><table tabindex="0"><thead><tr><th>工具</th><th>特点</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>pnpm + Workspaces</strong></td><td>轻量、原生支持、依赖扁平化</td><td>简单共享依赖</td></tr><tr><td><strong>Yarn Workspaces</strong></td><td>生态成熟、与 Yarn 深度集成</td><td>已使用 Yarn 的项目</td></tr><tr><td><strong>Lerna</strong></td><td>专注包管理（发布/版本）</td><td>多 npm 包维护</td></tr><tr><td><strong>Nx</strong></td><td>智能任务调度、远程缓存、插件生态</td><td>大型全栈项目（React + Node + NestJS）</td></tr><tr><td><strong>Turborepo</strong></td><td>极速增量构建、云缓存、简单配置</td><td>Vite/Next.js 等现代框架</td></tr></tbody></table><blockquote><p>💡 <strong>趋势</strong>：<br> 新项目推荐 <strong>pnpm + Turborepo/Nx</strong> —— pnpm 解决依赖，Turborepo/Nx 解决任务编排。</p></blockquote><hr><h3 id="五、典型应用场景" tabindex="-1">五、典型应用场景 <a class="header-anchor" href="#五、典型应用场景" aria-label="Permalink to “五、典型应用场景”">​</a></h3><ol><li><strong>组件库 + 应用</strong><ul><li>如：<code>@myorg/ui</code> 组件库 + <code>dashboard</code> 后台系统。</li></ul></li><li><strong>微前端架构</strong><ul><li>主应用 + 多个子应用（<code>app1</code>, <code>app2</code>）共享工具函数。</li></ul></li><li><strong>全栈项目</strong><ul><li>前端（React）、后端（NestJS）、CLI 工具共用类型定义和工具函数。</li></ul></li><li><strong>多端应用</strong><ul><li>Web + Mobile (React Native) + Desktop (Electron) 共享业务逻辑。</li></ul></li></ol><hr><h3 id="六、一句话总结-5" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-5" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>Monorepo 不是“把所有代码塞进一个仓库”，而是通过工具链实现“高内聚、低耦合”的协同开发模式——它用工程化手段解决了跨项目协作的摩擦，是大型前端团队提升交付效率的关键实践。</strong></p></blockquote><h2 id="你在项目是怎么做-monorepo" tabindex="-1">你在项目是怎么做 Monorepo？ <a class="header-anchor" href="#你在项目是怎么做-monorepo" aria-label="Permalink to “你在项目是怎么做 Monorepo？”">​</a></h2><p>在实际项目中，我采用 <strong>“pnpm + Turborepo + Changesets”</strong> 的组合来搭建和维护 Monorepo，兼顾<strong>开发体验、构建性能、依赖管理和发布流程</strong>。以下是我落地 Monorepo 的完整实践方案：</p><hr><h3 id="一、项目结构设计-清晰分层" tabindex="-1">一、项目结构设计（清晰分层） <a class="header-anchor" href="#一、项目结构设计-清晰分层" aria-label="Permalink to “一、项目结构设计（清晰分层）”">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">my-project/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apps/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 应用层（可独立部署）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> web/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # Next.js 前端应用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> api/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # NestJS 后端服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packages/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 共享包（可独立发布）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ui/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # React 组件库（含 Storybook）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> types/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 全局 TypeScript 类型定义</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # ESLint / TypeScript / Babel 共享配置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> utils/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 工具函数（如日期处理、API 客户端）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tools/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 自定义脚本（如代码生成器）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package.json</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 根工作区声明</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pnpm-workspace.yaml</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # pnpm 工作区配置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> turbo.json</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # Turborepo 任务编排</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .changeset/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # Changesets 发布配置</span></span></code></pre></div><blockquote><p>✅ <strong>原则</strong>：</p><ul><li><code>apps/</code> 只包含可运行的应用；</li><li><code>packages/</code> 必须是<strong>无副作用、可独立测试、可发布</strong>的模块。</li></ul></blockquote><hr><h3 id="二、核心工具链选型与配置" tabindex="-1">二、核心工具链选型与配置 <a class="header-anchor" href="#二、核心工具链选型与配置" aria-label="Permalink to “二、核心工具链选型与配置”">​</a></h3><h4 id="_1-依赖管理-pnpm-workspaces" tabindex="-1">1. <strong>依赖管理：pnpm Workspaces</strong> <a class="header-anchor" href="#_1-依赖管理-pnpm-workspaces" aria-label="Permalink to “1. 依赖管理：pnpm Workspaces”">​</a></h4><ul><li><p><strong>优势</strong>：硬链接 + 符号链接，节省磁盘空间，避免依赖冲突。</p></li><li><p><strong>配置</strong>：</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># pnpm-workspace.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">packages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;apps/*&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;packages/*&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tools/*&quot;</span></span></code></pre></div></li><li><p><strong>使用</strong>：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 在 web 应用中添加对 ui 包的依赖</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @myorg/ui</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./apps/web</span></span></code></pre></div></li></ul><h4 id="_2-任务编排-turborepo-关键提速" tabindex="-1">2. <strong>任务编排：Turborepo（关键提速）</strong> <a class="header-anchor" href="#_2-任务编排-turborepo-关键提速" aria-label="Permalink to “2. 任务编排：Turborepo（关键提速）”">​</a></h4><ul><li><p><strong>作用</strong>：智能并行执行任务 + 远程缓存。</p></li><li><p><strong>配置</strong>：</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// turbo.json</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;pipeline&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;build&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;dependsOn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;^build&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 依赖其他包的 build</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;outputs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;.next/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dist/**&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;dependsOn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;build&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;outputs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;dev&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;cache&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 开发命令不缓存</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;persistent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 持久化运行（如 dev server）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>效果</strong>：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 只构建受影响的包（利用缓存）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> turbo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 并行启动所有应用的开发服务器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> turbo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --parallel</span></span></code></pre></div></li></ul><h4 id="_3-版本发布-changesets-自动化语义化发布" tabindex="-1">3. <strong>版本发布：Changesets（自动化语义化发布）</strong> <a class="header-anchor" href="#_3-版本发布-changesets-自动化语义化发布" aria-label="Permalink to “3. 版本发布：Changesets（自动化语义化发布）”">​</a></h4><ul><li><strong>流程</strong>： <ol><li>开发者提交 PR 时，运行 <code>pnpm changeset</code> 生成变更记录；</li><li>CI 合并 PR 后，自动创建版本发布 PR；</li><li>合并发布 PR → 自动打 tag + 发布 npm 包。</li></ol></li><li><strong>优势</strong>： <ul><li>精确控制每个包的版本（major/minor/patch）；</li><li>自动生成 CHANGELOG。</li></ul></li></ul><hr><h3 id="三、关键实践细节" tabindex="-1">三、关键实践细节 <a class="header-anchor" href="#三、关键实践细节" aria-label="Permalink to “三、关键实践细节”">​</a></h3><h4 id="✅-1-共享配置-避免重复" tabindex="-1">✅ 1. <strong>共享配置（避免重复）</strong> <a class="header-anchor" href="#✅-1-共享配置-避免重复" aria-label="Permalink to “✅ 1. 共享配置（避免重复）”">​</a></h4><ul><li>将 ESLint、TypeScript、Jest 配置抽离到 <code>packages/config</code>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// apps/web/eslint.config.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> baseConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@myorg/config/eslint&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseConfig, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 项目特有规则 */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span></code></pre></div></li></ul><h4 id="✅-2-类型安全跨包引用" tabindex="-1">✅ 2. <strong>类型安全跨包引用</strong> <a class="header-anchor" href="#✅-2-类型安全跨包引用" aria-label="Permalink to “✅ 2. 类型安全跨包引用”">​</a></h4><ul><li><code>packages/types</code> 导出全局类型：<div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// packages/types/src/user.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// apps/web/src/pages/profile.tsx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { User } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@myorg/types&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 类型安全！</span></span></code></pre></div></li></ul><h4 id="✅-3-本地开发联动" tabindex="-1">✅ 3. <strong>本地开发联动</strong> <a class="header-anchor" href="#✅-3-本地开发联动" aria-label="Permalink to “✅ 3. 本地开发联动”">​</a></h4><ul><li>修改 <code>packages/ui</code> 后，<code>apps/web</code> <strong>实时热更新</strong>（无需重新安装）；</li><li>通过 <code>pnpm link</code> 或 Turborepo 的 <code>--continue</code> 保证一致性。</li></ul><h4 id="✅-4-ci-优化-只跑受影响的任务" tabindex="-1">✅ 4. <strong>CI 优化（只跑受影响的任务）</strong> <a class="header-anchor" href="#✅-4-ci-优化-只跑受影响的任务" aria-label="Permalink to “✅ 4. CI 优化（只跑受影响的任务）”">​</a></h4><ul><li>GitHub Actions 示例：<div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Run affected tests</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    TURBO_TOKEN=${{ secrets.TURBO_TOKEN }}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    TURBO_TEAM=${{ vars.TURBO_TEAM }}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pnpm turbo run test --filter=...</span></span></code></pre></div></li><li>利用 Turborepo <strong>远程缓存</strong>，跳过已构建的包。</li></ul><hr><h3 id="四、避坑经验" tabindex="-1">四、避坑经验 <a class="header-anchor" href="#四、避坑经验" aria-label="Permalink to “四、避坑经验”">​</a></h3><table tabindex="0"><thead><tr><th>问题</th><th>解决方案</th></tr></thead><tbody><tr><td><strong>循环依赖</strong></td><td>用 <code>madge</code> 扫描依赖图，禁止 <code>packages/</code> 间循环引用</td></tr><tr><td><strong>发布混乱</strong></td><td>强制 PR 关联 Changeset 文件，否则 CI 失败</td></tr><tr><td><strong>构建缓慢</strong></td><td>启用 Turborepo 远程缓存（Vercel 提供免费额度）</td></tr><tr><td><strong>IDE 卡顿</strong></td><td>在 VS Code 中排除 <code>node_modules</code> 和构建产物目录</td></tr></tbody></table><hr><h3 id="五、效果对比-真实项目数据" tabindex="-1">五、效果对比（真实项目数据） <a class="header-anchor" href="#五、效果对比-真实项目数据" aria-label="Permalink to “五、效果对比（真实项目数据）”">​</a></h3><table tabindex="0"><thead><tr><th>指标</th><th>Multirepo</th><th>Monorepo (pnpm+Turborepo)</th></tr></thead><tbody><tr><td>首次安装依赖</td><td>8 分钟</td><td>2 分钟（硬链接复用）</td></tr><tr><td>全量构建</td><td>120s</td><td>45s（缓存 + 并行）</td></tr><tr><td>跨包修改验证</td><td>需手动 link/发版</td><td>保存即生效</td></tr><tr><td>新成员上手</td><td>需配置多个仓库</td><td>克隆一个仓库 + <code>pnpm install</code></td></tr></tbody></table><hr><h3 id="一句话总结-4" tabindex="-1">一句话总结 <a class="header-anchor" href="#一句话总结-4" aria-label="Permalink to “一句话总结”">​</a></h3><blockquote><p><strong>我的 Monorepo 实践 = pnpm（依赖） + Turborepo（构建） + Changesets（发布） + 严格分层（架构），目标是让跨项目协作像单体应用一样简单，同时保留微包的灵活性。</strong></p></blockquote><h2 id="为什么-pnpm-比-npm-快" tabindex="-1">为什么 pnpm 比 npm 快？ <a class="header-anchor" href="#为什么-pnpm-比-npm-快" aria-label="Permalink to “为什么 pnpm 比 npm 快？”">​</a></h2><p><code>pnpm</code> 比 <code>npm</code> 快，<strong>核心原因在于其独特的依赖存储和安装机制</strong>——它通过 <strong>硬链接（hard links） + 符号链接（symlinks） + 内容可寻址存储（Content-Addressable Store）</strong>，避免了重复下载和复制文件，大幅提升了安装速度、节省磁盘空间，并保证了依赖一致性。</p><hr><h3 id="一、根本区别-依赖存储模型" tabindex="-1">一、根本区别：依赖存储模型 <a class="header-anchor" href="#一、根本区别-依赖存储模型" aria-label="Permalink to “一、根本区别：依赖存储模型”">​</a></h3><table tabindex="0"><thead><tr><th>包管理器</th><th>依赖存储方式</th><th>磁盘占用</th><th>安装速度</th></tr></thead><tbody><tr><td><strong>npm</strong></td><td>每个项目独立 <code>node_modules</code>（嵌套或扁平）</td><td>高（重复依赖多次存储）</td><td>慢（大量文件复制）</td></tr><tr><td><strong>pnpm</strong></td><td>全局内容可寻址存储 + 硬链接</td><td>极低（相同依赖只存一份）</td><td>极快（无文件复制）</td></tr></tbody></table><hr><h3 id="二、pnpm-的三大核心技术" tabindex="-1">二、pnpm 的三大核心技术 <a class="header-anchor" href="#二、pnpm-的三大核心技术" aria-label="Permalink to “二、pnpm 的三大核心技术”">​</a></h3><h4 id="_1-全局内容可寻址存储-store" tabindex="-1">1. <strong>全局内容可寻址存储（Store）</strong> <a class="header-anchor" href="#_1-全局内容可寻址存储-store" aria-label="Permalink to “1. 全局内容可寻址存储（Store）”">​</a></h4><ul><li>所有依赖包被解压并存储在 <strong>全局唯一位置</strong>（如 <code>~/.pnpm-store</code>）；</li><li>路径按 <strong>包名 + 版本 + 完整依赖树哈希</strong> 生成，确保<strong>完全确定性</strong>：<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>~/.pnpm-store/v3/files/</span></span>
<span class="line"><span>└── abc123.../         # 文件内容的哈希</span></span>
<span class="line"><span>    └── index.js       # 实际文件内容</span></span></code></pre></div></li></ul><h4 id="_2-硬链接-hard-links-复用文件" tabindex="-1">2. <strong>硬链接（Hard Links）复用文件</strong> <a class="header-anchor" href="#_2-硬链接-hard-links-复用文件" aria-label="Permalink to “2. 硬链接（Hard Links）复用文件”">​</a></h4><ul><li>当项目需要某个依赖时，pnpm <strong>不在 <code>node_modules</code> 中复制文件</strong>，而是创建<strong>硬链接</strong>指向全局 Store 中的文件；</li><li><strong>硬链接特点</strong>： <ul><li>多个路径指向同一份物理数据；</li><li>修改任一链接 = 修改所有（但依赖是只读的，安全）；</li><li>几乎零磁盘开销 &amp; 零复制时间。</li></ul></li></ul><blockquote><p>💡 <strong>对比 npm</strong>：<br> npm 会将每个依赖完整复制到 <code>node_modules</code>，10 个项目用同一个 lodash → 磁盘存 10 份。</p></blockquote><h4 id="_3-符号链接-symlinks-构建依赖树" tabindex="-1">3. <strong>符号链接（Symlinks）构建依赖树</strong> <a class="header-anchor" href="#_3-符号链接-symlinks-构建依赖树" aria-label="Permalink to “3. 符号链接（Symlinks）构建依赖树”">​</a></h4><ul><li>pnpm 在项目 <code>node_modules</code> 中只创建<strong>符号链接</strong>，形成符合 Node.js 解析规则的目录结构：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">my-project/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node_modules/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .pnpm/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 真实依赖存储区（扁平化）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lodash@4.17.21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.pnpm-store/...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react@18.2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.pnpm-store/...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lodash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .pnpm/lodash@4.17.21/node_modules/lodash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .pnpm/react@18.2.0/node_modules/react</span></span></code></pre></div></li><li><strong>优势</strong>： <ul><li>避免 npm/yarn 的“幽灵依赖”（phantom dependencies）；</li><li>严格遵循 <code>package.json</code> 声明的依赖关系。</li></ul></li></ul><hr><h3 id="三、性能对比-实测数据" tabindex="-1">三、性能对比（实测数据） <a class="header-anchor" href="#三、性能对比-实测数据" aria-label="Permalink to “三、性能对比（实测数据）”">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>npm (v9)</th><th>pnpm (v8)</th><th>提升</th></tr></thead><tbody><tr><td><strong>首次安装</strong>（大型项目）</td><td>45s</td><td>22s</td><td>≈2x</td></tr><tr><td><strong>二次安装</strong>（缓存命中）</td><td>30s</td><td><strong>3s</strong></td><td><strong>10x</strong></td></tr><tr><td><strong>磁盘占用</strong>（10 个相似项目）</td><td>1.2 GB</td><td><strong>200 MB</strong></td><td><strong>6x 节省</strong></td></tr><tr><td><strong>CI 环境安装</strong></td><td>慢（需下载+解压）</td><td>极快（复用 Store）</td><td>显著提速</td></tr></tbody></table><blockquote><p>🔍 <strong>关键</strong>：pnpm 的 Store 可跨项目、跨 CI Job 复用（配合缓存策略）。</p></blockquote><hr><h3 id="四、额外优势-不仅是快" tabindex="-1">四、额外优势（不仅是快） <a class="header-anchor" href="#四、额外优势-不仅是快" aria-label="Permalink to “四、额外优势（不仅是快）”">​</a></h3><h4 id="✅-1-杜绝-幽灵依赖" tabindex="-1">✅ 1. <strong>杜绝“幽灵依赖”</strong> <a class="header-anchor" href="#✅-1-杜绝-幽灵依赖" aria-label="Permalink to “✅ 1. 杜绝“幽灵依赖””">​</a></h4><ul><li>npm/yarn 允许代码直接引用未声明的依赖（因 <code>node_modules</code> 扁平化）；</li><li>pnpm 的严格符号链接结构<strong>强制显式声明依赖</strong>，提升项目健壮性。</li></ul><h4 id="✅-2-monorepo-友好" tabindex="-1">✅ 2. <strong>Monorepo 友好</strong> <a class="header-anchor" href="#✅-2-monorepo-友好" aria-label="Permalink to “✅ 2. Monorepo 友好”">​</a></h4><ul><li>在 Monorepo 中，所有子项目共享同一个 Store；</li><li><code>pnpm install</code> 一次安装所有 workspace 依赖，无重复。</li></ul><h4 id="✅-3-离线模式更强" tabindex="-1">✅ 3. <strong>离线模式更强</strong> <a class="header-anchor" href="#✅-3-离线模式更强" aria-label="Permalink to “✅ 3. 离线模式更强”">​</a></h4><ul><li>全局 Store 相当于本地缓存，即使断网也能安装已下载过的依赖。</li></ul><hr><h3 id="五、为什么-npm-不这么设计" tabindex="-1">五、为什么 npm 不这么设计？ <a class="header-anchor" href="#五、为什么-npm-不这么设计" aria-label="Permalink to “五、为什么 npm 不这么设计？”">​</a></h3><ul><li><strong>历史包袱</strong>：npm 早期为简单性采用直接复制；</li><li><strong>兼容性</strong>：部分工具假设 <code>node_modules</code> 是真实文件（pnpm 通过 <code>--shamefully-hoist</code> 兼容）；</li><li><strong>生态惯性</strong>：改变底层模型风险高。</li></ul><blockquote><p>💡 <strong>现状</strong>：Yarn v2+（PnP）也采用类似思路，但 pnpm 因<strong>兼容传统 <code>node_modules</code> 结构</strong>更易迁移。</p></blockquote><hr><h3 id="六、一句话总结-6" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-6" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>pnpm 快在“不复制”——用硬链接共享全局存储的依赖文件，用符号链接构建精准依赖树，既省空间又提速，还顺手解决了 npm 的依赖隐患。</strong></p></blockquote><h2 id="eslint-概念及原理" tabindex="-1">ESLint 概念及原理 <a class="header-anchor" href="#eslint-概念及原理" aria-label="Permalink to “ESLint 概念及原理”">​</a></h2><p><strong>ESLint</strong> 是一个<strong>可插件化、高度可配置的 JavaScript/TypeScript 代码检查工具</strong>，用于在开发阶段<strong>静态分析代码</strong>，发现潜在错误、风格问题和不规范写法，从而提升代码质量和团队协作一致性。</p><hr><h3 id="一、核心概念" tabindex="-1">一、核心概念 <a class="header-anchor" href="#一、核心概念" aria-label="Permalink to “一、核心概念”">​</a></h3><h4 id="_1-linter-代码检查器" tabindex="-1">1. <strong>Linter（代码检查器）</strong> <a class="header-anchor" href="#_1-linter-代码检查器" aria-label="Permalink to “1. Linter（代码检查器）”">​</a></h4><ul><li>静态分析源码（无需运行），检查： <ul><li>语法错误（如未定义变量）；</li><li>潜在 bug（如 <code>==</code> vs <code>===</code>）；</li><li>代码风格（缩进、引号、分号等）；</li><li>最佳实践（如避免 <code>console.log</code> 上线）。</li></ul></li></ul><h4 id="_2-规则-rules" tabindex="-1">2. <strong>规则（Rules）</strong> <a class="header-anchor" href="#_2-规则-rules" aria-label="Permalink to “2. 规则（Rules）”">​</a></h4><ul><li>ESLint 的最小检查单元，每条规则独立开关；</li><li>示例：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;no-console&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;warn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 禁止 console（警告）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;semi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;always&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 必须加分号（报错）</span></span></code></pre></div></li></ul><h4 id="_3-配置文件-configuration" tabindex="-1">3. <strong>配置文件（Configuration）</strong> <a class="header-anchor" href="#_3-配置文件-configuration" aria-label="Permalink to “3. 配置文件（Configuration）”">​</a></h4><ul><li>支持多种格式：<code>.eslintrc.js</code>、<code>.eslintrc.json</code>、<code>package.json</code> 中的 <code>eslintConfig</code>；</li><li>可继承共享配置（如 <code>eslint:recommended</code>、<code>@typescript-eslint/recommended</code>）。</li></ul><h4 id="_4-解析器-parser" tabindex="-1">4. <strong>解析器（Parser）</strong> <a class="header-anchor" href="#_4-解析器-parser" aria-label="Permalink to “4. 解析器（Parser）”">​</a></h4><ul><li>默认使用 Espree（基于 Acorn），支持 ES5~ES2023；</li><li>扩展场景： <ul><li>TypeScript → <code>@typescript-eslint/parser</code>；</li><li>Vue → <code>vue-eslint-parser</code>。</li></ul></li></ul><h4 id="_5-插件-plugins" tabindex="-1">5. <strong>插件（Plugins）</strong> <a class="header-anchor" href="#_5-插件-plugins" aria-label="Permalink to “5. 插件（Plugins）”">​</a></h4><ul><li>扩展 ESLint 能力，提供<strong>自定义规则/解析器</strong>；</li><li>命名规范：<code>eslint-plugin-xxx</code>（使用时省略前缀）；</li><li>示例：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;react&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@typescript-eslint&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li></ul><h4 id="_6-可共享配置-shareable-configs" tabindex="-1">6. <strong>可共享配置（Shareable Configs）</strong> <a class="header-anchor" href="#_6-可共享配置-shareable-configs" aria-label="Permalink to “6. 可共享配置（Shareable Configs）”">​</a></h4><ul><li>封装常用规则集，便于团队复用；</li><li>命名规范：<code>eslint-config-xxx</code>（使用时加 <code>xxx</code>）；</li><li>示例：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;airbnb&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;plugin:react/recommended&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li></ul><hr><h3 id="二、工作原理-四步流程" tabindex="-1">二、工作原理（四步流程） <a class="header-anchor" href="#二、工作原理-四步流程" aria-label="Permalink to “二、工作原理（四步流程）”">​</a></h3><div class="language-mermaid"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph LR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A[源代码] --&gt; B[解析器 Parser]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">B --&gt; C[AST 抽象语法树]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C --&gt; D[规则遍历 AST]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D --&gt; E[报告问题]</span></span></code></pre></div><h4 id="_1-解析代码-→-生成-ast" tabindex="-1">1. <strong>解析代码 → 生成 AST</strong> <a class="header-anchor" href="#_1-解析代码-→-生成-ast" aria-label="Permalink to “1. 解析代码 → 生成 AST”">​</a></h4><ul><li>ESLint 调用配置的 <strong>Parser</strong>（如 <code>@typescript-eslint/parser</code>）；</li><li>将源码转换为 <strong>AST（Abstract Syntax Tree）</strong>，结构化表示代码逻辑。</li></ul><h4 id="_2-遍历-ast-→-触发规则" tabindex="-1">2. <strong>遍历 AST → 触发规则</strong> <a class="header-anchor" href="#_2-遍历-ast-→-触发规则" aria-label="Permalink to “2. 遍历 AST → 触发规则”">​</a></h4><ul><li>ESLint 使用 <strong>深度优先遍历</strong> AST；</li><li>每遇到一个节点（如 <code>VariableDeclaration</code>, <code>CallExpression</code>），触发注册的规则监听器。</li></ul><h4 id="_3-规则执行-→-检查逻辑" tabindex="-1">3. <strong>规则执行 → 检查逻辑</strong> <a class="header-anchor" href="#_3-规则执行-→-检查逻辑" aria-label="Permalink to “3. 规则执行 → 检查逻辑”">​</a></h4><ul><li>每条规则是一个函数，接收 AST 节点并判断是否违规；</li><li>示例：<code>no-var</code> 规则会检查是否存在 <code>VariableDeclaration</code> 且 <code>kind === &#39;var&#39;</code>。</li></ul><h4 id="_4-生成报告-→-输出结果" tabindex="-1">4. <strong>生成报告 → 输出结果</strong> <a class="header-anchor" href="#_4-生成报告-→-输出结果" aria-label="Permalink to “4. 生成报告 → 输出结果”">​</a></h4><ul><li>汇总所有违规项，按配置输出： <ul><li>终端高亮显示；</li><li>IDE 实时标红（通过 ESLint 插件）；</li><li>CI 失败（若设为 <code>error</code>）。</li></ul></li></ul><hr><h3 id="三、关键特性" tabindex="-1">三、关键特性 <a class="header-anchor" href="#三、关键特性" aria-label="Permalink to “三、关键特性”">​</a></h3><h4 id="✅-1-可插拔架构" tabindex="-1">✅ 1. <strong>可插拔架构</strong> <a class="header-anchor" href="#✅-1-可插拔架构" aria-label="Permalink to “✅ 1. 可插拔架构”">​</a></h4><ul><li>解析器、规则、插件均可替换，支持任意语言扩展（TS/JSX/Vue）。</li></ul><h4 id="✅-2-自动修复-fix" tabindex="-1">✅ 2. <strong>自动修复（--fix）</strong> <a class="header-anchor" href="#✅-2-自动修复-fix" aria-label="Permalink to “✅ 2. 自动修复（--fix）”">​</a></h4><ul><li>部分规则支持自动修复（如格式问题）：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eslint</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --fix</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/</span></span></code></pre></div></li></ul><h4 id="✅-3-作用域分析-scope-analysis" tabindex="-1">✅ 3. <strong>作用域分析（Scope Analysis）</strong> <a class="header-anchor" href="#✅-3-作用域分析-scope-analysis" aria-label="Permalink to “✅ 3. 作用域分析（Scope Analysis）”">​</a></h4><ul><li>内置作用域管理器，精准判断变量声明/引用关系；</li><li>例如：检测“变量未定义”时，会检查当前作用域链。</li></ul><h4 id="✅-4-配置级联与覆盖" tabindex="-1">✅ 4. <strong>配置级联与覆盖</strong> <a class="header-anchor" href="#✅-4-配置级联与覆盖" aria-label="Permalink to “✅ 4. 配置级联与覆盖”">​</a></h4><ul><li>支持目录级 <code>.eslintrc</code>，子目录自动继承父级配置；</li><li>可通过 <code>overrides</code> 对特定文件（如 <code>*.test.js</code>）定制规则。</li></ul><hr><h3 id="四、典型配置示例" tabindex="-1">四、典型配置示例 <a class="header-anchor" href="#四、典型配置示例" aria-label="Permalink to “四、典型配置示例”">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// .eslintrc.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 指定环境（注入全局变量）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  env: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    browser: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    es2021: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    node: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 继承推荐规则</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  extends: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;eslint:recommended&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;@typescript-eslint/recommended&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 指定解析器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  parser: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@typescript-eslint/parser&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 加载插件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@typescript-eslint&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 自定义规则</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  rules: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;no-console&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;warn&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;@typescript-eslint/no-explicit-any&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;error&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 指定文件类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  overrides: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      files: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;*.test.ts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      rules: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;no-unused-expressions&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;off&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><hr><h3 id="五、eslint-vs-其他工具" tabindex="-1">五、ESLint vs 其他工具 <a class="header-anchor" href="#五、eslint-vs-其他工具" aria-label="Permalink to “五、ESLint vs 其他工具”">​</a></h3><table tabindex="0"><thead><tr><th>工具</th><th>定位</th><th>互补性</th></tr></thead><tbody><tr><td><strong>Prettier</strong></td><td>代码格式化（美观）</td><td>✅ 与 ESLint 分工：ESLint 管逻辑，Prettier 管风格</td></tr><tr><td><strong>TypeScript</strong></td><td>类型检查</td><td>✅ ESLint 补充 TS 无法覆盖的运行时问题（如 <code>no-param-reassign</code>）</td></tr><tr><td><strong>JSHint</strong></td><td>老一代 Linter</td><td>❌ 功能弱于 ESLint，已基本淘汰</td></tr></tbody></table><blockquote><p>💡 <strong>最佳实践</strong>：<br> ESLint + Prettier + TypeScript = 现代前端代码质量铁三角。</p></blockquote><hr><h3 id="六、一句话总结-7" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-7" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>ESLint 通过解析代码为 AST，遍历节点触发规则检查，在编码阶段拦截问题——它是 JavaScript 生态中不可或缺的“代码守门员”。</strong></p></blockquote><h2 id="babel-概念及原理" tabindex="-1">Babel 概念及原理 <a class="header-anchor" href="#babel-概念及原理" aria-label="Permalink to “Babel 概念及原理”">​</a></h2><p><strong>Babel</strong> 是一个 <strong>JavaScript 编译器（Compiler）</strong>，核心功能是将<strong>新版或实验性 JavaScript 代码</strong>（如 ES2023、TypeScript、JSX）<strong>转换为向后兼容的旧版 JavaScript</strong>（如 ES5），以确保代码能在不支持新特性的浏览器或环境中运行。</p><blockquote><p>📌 <strong>定位</strong>：不是打包工具（如 Webpack），而是<strong>源码转换工具</strong>（Transpiler）。</p></blockquote><hr><h3 id="一、核心概念-1" tabindex="-1">一、核心概念 <a class="header-anchor" href="#一、核心概念-1" aria-label="Permalink to “一、核心概念”">​</a></h3><h4 id="_1-转译-transpilation" tabindex="-1">1. <strong>转译（Transpilation）</strong> <a class="header-anchor" href="#_1-转译-transpilation" aria-label="Permalink to “1. 转译（Transpilation）”">​</a></h4><ul><li>将一种 JavaScript 语法（高版本/扩展语法） → 转换为另一种等效的低版本语法；</li><li>示例：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 输入（ES2020）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Babel 输出（ES5）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></li></ul><h4 id="_2-预设-presets" tabindex="-1">2. <strong>预设（Presets）</strong> <a class="header-anchor" href="#_2-预设-presets" aria-label="Permalink to “2. 预设（Presets）”">​</a></h4><ul><li>一组<strong>插件的集合</strong>，用于处理特定场景；</li><li>常用预设： <ul><li><code>@babel/preset-env</code>：智能转换 ES6+ 语法（按目标环境）；</li><li><code>@babel/preset-react</code>：转换 JSX；</li><li><code>@babel/preset-typescript</code>：移除 TypeScript 类型注解。</li></ul></li></ul><h4 id="_3-插件-plugins" tabindex="-1">3. <strong>插件（Plugins）</strong> <a class="header-anchor" href="#_3-插件-plugins" aria-label="Permalink to “3. 插件（Plugins）”">​</a></h4><ul><li>执行<strong>单一转换任务</strong>的模块；</li><li>示例： <ul><li><code>@babel/plugin-transform-arrow-functions</code>：转换箭头函数；</li><li><code>@babel/plugin-proposal-class-properties</code>：支持 class 字段（<code>class A { x = 1 }</code>）。</li></ul></li></ul><h4 id="_4-polyfill-垫片" tabindex="-1">4. <strong>Polyfill（垫片）</strong> <a class="header-anchor" href="#_4-polyfill-垫片" aria-label="Permalink to “4. Polyfill（垫片）”">​</a></h4><ul><li>Babel <strong>只转换语法</strong>，不提供新 API（如 <code>Promise</code>, <code>Array.from</code>）；</li><li>需配合 <code>core-js</code> 等 Polyfill 库补充缺失的全局对象/方法。</li></ul><hr><h3 id="二、工作原理-三步编译流程" tabindex="-1">二、工作原理（三步编译流程） <a class="header-anchor" href="#二、工作原理-三步编译流程" aria-label="Permalink to “二、工作原理（三步编译流程）”">​</a></h3><p><img src="/vitepress_docs/assets/tongyi-mermaid-2026-01-05-140116.k0cZjS8Y.png" alt="An Image"></p><h4 id="_1-解析-parsing" tabindex="-1">1. <strong>解析（Parsing）</strong> <a class="header-anchor" href="#_1-解析-parsing" aria-label="Permalink to “1. 解析（Parsing）”">​</a></h4><ul><li>使用 <strong>解析器</strong>（默认 <code>@babel/parser</code>，原名 Babylon）将源码转换为 <strong>AST（Abstract Syntax Tree）</strong>；</li><li>AST 是代码的结构化表示，便于分析和修改。</li></ul><h4 id="_2-转换-transformation" tabindex="-1">2. <strong>转换（Transformation）</strong> <a class="header-anchor" href="#_2-转换-transformation" aria-label="Permalink to “2. 转换（Transformation）”">​</a></h4><ul><li>遍历 AST，应用配置的 <strong>插件/预设</strong> 对节点进行增删改；</li><li>每个插件通过 <strong>访问者模式（Visitor Pattern）</strong> 监听特定 AST 节点：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 插件示例：将 console.log 替换为 alert</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    visitor: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      CallExpression</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (path.node.callee.object?.name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;console&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            path.node.callee.property?.name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;log&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replaceWith</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">callExpression</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">identifier</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;alert&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), path.node.arguments)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="_3-生成-code-generation" tabindex="-1">3. <strong>生成（Code Generation）</strong> <a class="header-anchor" href="#_3-生成-code-generation" aria-label="Permalink to “3. 生成（Code Generation）”">​</a></h4><ul><li>使用 <strong>代码生成器</strong>（<code>@babel/generator</code>）将修改后的 AST 转回字符串形式的 JavaScript 代码。</li></ul><hr><h3 id="三、关键特性-1" tabindex="-1">三、关键特性 <a class="header-anchor" href="#三、关键特性-1" aria-label="Permalink to “三、关键特性”">​</a></h3><h4 id="✅-1-按需转换-babel-preset-env" tabindex="-1">✅ 1. <strong>按需转换（@babel/preset-env）</strong> <a class="header-anchor" href="#✅-1-按需转换-babel-preset-env" aria-label="Permalink to “✅ 1. 按需转换（@babel/preset-env）”">​</a></h4><ul><li>通过 <code>browserslist</code> 配置目标环境，<strong>只转换不支持的语法</strong>：<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// .browserslistrc</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">not dead</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// babel.config.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">presets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@babel/preset-env&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { targets: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;defaults&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li><li>结合 <code>useBuiltIns: &#39;usage&#39;</code> 实现<strong>按需注入 Polyfill</strong>。</li></ul><h4 id="✅-2-支持扩展语法" tabindex="-1">✅ 2. <strong>支持扩展语法</strong> <a class="header-anchor" href="#✅-2-支持扩展语法" aria-label="Permalink to “✅ 2. 支持扩展语法”">​</a></h4><ul><li>JSX → React.createElement()</li><li>TypeScript → 移除类型注解（保留运行时逻辑）</li><li>Flow → 类型擦除</li></ul><h4 id="✅-3-插件化架构" tabindex="-1">✅ 3. <strong>插件化架构</strong> <a class="header-anchor" href="#✅-3-插件化架构" aria-label="Permalink to “✅ 3. 插件化架构”">​</a></h4><ul><li>社区提供数千插件，支持实验性提案（如装饰器、管道操作符）；</li><li>可自定义插件实现代码优化、埋点注入等。</li></ul><hr><h3 id="四、典型配置示例-1" tabindex="-1">四、典型配置示例 <a class="header-anchor" href="#四、典型配置示例-1" aria-label="Permalink to “四、典型配置示例”">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// babel.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  presets: [</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 智能转换 ES6+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@babel/preset-env&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      targets: { browsers: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&gt; 1%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;not ie &lt;= 11&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      useBuiltIns: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;usage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 按需引入 core-js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      corejs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }],</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 转换 JSX</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@babel/preset-react&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { runtime: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;automatic&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }],</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 移除 TS 类型</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;@babel/preset-typescript&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 支持 class 属性</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;@babel/plugin-proposal-class-properties&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 自动引入 Polyfill（已由 preset-env 处理）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><hr><h3 id="五、babel-vs-其他工具" tabindex="-1">五、Babel vs 其他工具 <a class="header-anchor" href="#五、babel-vs-其他工具" aria-label="Permalink to “五、Babel vs 其他工具”">​</a></h3><table tabindex="0"><thead><tr><th>工具</th><th>定位</th><th>与 Babel 关系</th></tr></thead><tbody><tr><td><strong>TypeScript Compiler (tsc)</strong></td><td>类型检查 + 转译</td><td>Babel <strong>不检查类型</strong>，仅擦除 TS 语法；常搭配使用（tsc 类型检查 + Babel 转译）</td></tr><tr><td><strong>SWC / esbuild</strong></td><td>超快 JS 转译器</td><td>Babel 的高性能替代品（Rust/Go 编写），但插件生态较弱</td></tr><tr><td><strong>Webpack</strong></td><td>模块打包器</td><td>Webpack 通过 <code>babel-loader</code> 调用 Babel 转译模块</td></tr></tbody></table><blockquote><p>💡 <strong>现代趋势</strong>：<br> 开发环境用 <strong>esbuild/SWC</strong> 提速，生产环境用 <strong>Babel</strong> 保证兼容性。</p></blockquote><hr><h3 id="六、一句话总结-8" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-8" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>Babel 是 JavaScript 的“语法翻译官”——它通过解析→转换→生成三步，将前沿代码安全降级为广泛兼容的版本，是现代前端工程化的基石工具。</strong></p></blockquote><h2 id="npm-install-的执行过程" tabindex="-1">npm install 的执行过程 <a class="header-anchor" href="#npm-install-的执行过程" aria-label="Permalink to “npm install 的执行过程”">​</a></h2><p><code>npm install</code> 的执行过程是一个<strong>多阶段、高度协同的依赖解析与安装流程</strong>，其核心目标是：<strong>根据 <code>package.json</code> 和 <code>package-lock.json</code>，在本地构建出一个符合语义化版本规则（SemVer）且可复现的 <code>node_modules</code> 目录结构</strong>。</p><p>以下是 <code>npm install</code>（以 npm v7+ 为例）的详细执行步骤：</p><hr><h3 id="一、整体流程概览" tabindex="-1">一、整体流程概览 <a class="header-anchor" href="#一、整体流程概览" aria-label="Permalink to “一、整体流程概览”">​</a></h3><p><img src="/vitepress_docs/assets/tongyi-mermaid-2026-01-05-140200.CoUrFAZI.png" alt="An Image"></p><hr><h3 id="二、详细执行步骤" tabindex="-1">二、详细执行步骤 <a class="header-anchor" href="#二、详细执行步骤" aria-label="Permalink to “二、详细执行步骤”">​</a></h3><h4 id="_1-读取配置与清单文件" tabindex="-1">1. <strong>读取配置与清单文件</strong> <a class="header-anchor" href="#_1-读取配置与清单文件" aria-label="Permalink to “1. 读取配置与清单文件”">​</a></h4><ul><li>读取当前目录的 <code>package.json</code>，获取： <ul><li><code>dependencies</code></li><li><code>devDependencies</code></li><li><code>optionalDependencies</code></li><li><code>engines</code>（Node/npm 版本要求）</li></ul></li><li>读取 <code>.npmrc</code> 配置（如 registry 源、缓存路径）。</li></ul><h4 id="_2-加载或生成依赖树-arborist-算法" tabindex="-1">2. <strong>加载或生成依赖树（Arborist 算法）</strong> <a class="header-anchor" href="#_2-加载或生成依赖树-arborist-算法" aria-label="Permalink to “2. 加载或生成依赖树（Arborist 算法）”">​</a></h4><ul><li>npm v7+ 使用 <strong>Arborist</strong>（“园丁”）引擎进行依赖解析；</li><li><strong>关键逻辑</strong>： <ul><li>若存在 <code>package-lock.json</code> 且与 <code>package.json</code> 兼容 → <strong>直接使用 lock 文件中的精确版本</strong>；</li><li>若 lock 文件缺失/过期 → <strong>重新计算依赖树</strong>，遵循 SemVer 规则（如 <code>^1.2.3</code> 允许 <code>1.x.x</code> 最新）。</li></ul></li></ul><blockquote><p>🔑 <strong>SemVer 规则示例</strong>：</p><ul><li><code>^1.2.3</code> → 允许 <code>1.2.4</code>, <code>1.3.0</code>，但不允许 <code>2.0.0</code></li><li><code>~1.2.3</code> → 允许 <code>1.2.4</code>，但不允许 <code>1.3.0</code></li></ul></blockquote><h4 id="_3-依赖去重与扁平化-npm-v2-vs-v3" tabindex="-1">3. <strong>依赖去重与扁平化（npm v2 vs v3+）</strong> <a class="header-anchor" href="#_3-依赖去重与扁平化-npm-v2-vs-v3" aria-label="Permalink to “3. 依赖去重与扁平化（npm v2 vs v3+）”">​</a></h4><ul><li><strong>npm v2</strong>：嵌套安装（<code>node_modules/a/node_modules/b</code>），导致重复依赖、路径过长；</li><li><strong>npm v3+</strong>：<strong>扁平化策略</strong>（尽可能将依赖提升到顶层）：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_modules/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lodash@4.17.21</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 被多个包依赖，只安装一份</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react@18.2.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-dom@18.2.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node_modules/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react@18.2.0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 若版本冲突，才嵌套</span></span></code></pre></div></li><li><strong>目的</strong>：减少磁盘占用，避免“依赖地狱”。</li></ul><h4 id="_4-从缓存或网络获取包" tabindex="-1">4. <strong>从缓存或网络获取包</strong> <a class="header-anchor" href="#_4-从缓存或网络获取包" aria-label="Permalink to “4. 从缓存或网络获取包”">​</a></h4><ul><li><strong>优先使用本地缓存</strong>（<code>~/.npm</code> 或项目级缓存）；</li><li>若缓存未命中： <ul><li>从配置的 registry（如 <code>https://registry.npmjs.org</code>）下载 tarball；</li><li>验证包完整性（通过 <code>integrity</code> 字段的 SHA 哈希）。</li></ul></li></ul><h4 id="_5-解压并构建-node-modules" tabindex="-1">5. <strong>解压并构建 <code>node_modules</code></strong> <a class="header-anchor" href="#_5-解压并构建-node-modules" aria-label="Permalink to “5. 解压并构建 node_modules”">​</a></h4><ul><li>将 tarball 解压到 <code>node_modules</code> 对应位置；</li><li>执行包的 <strong><code>preinstall</code> / <code>install</code> / <code>postinstall</code> 脚本</strong>（如 <code>node-gyp</code> 编译原生模块）。</li></ul><h4 id="_6-更新或生成-package-lock-json" tabindex="-1">6. <strong>更新或生成 <code>package-lock.json</code></strong> <a class="header-anchor" href="#_6-更新或生成-package-lock-json" aria-label="Permalink to “6. 更新或生成 package-lock.json”">​</a></h4><ul><li><strong>lock 文件作用</strong>： <ul><li>锁定所有依赖的<strong>精确版本 + 完整依赖树 + integrity 哈希</strong>；</li><li>确保团队成员和 CI 环境安装<strong>完全一致</strong>的依赖。</li></ul></li><li>若 <code>package.json</code> 有变更 → 生成新 lock 文件；</li><li>若无变更 → 仅验证 lock 文件有效性。</li></ul><h4 id="_7-运行项目生命周期脚本" tabindex="-1">7. <strong>运行项目生命周期脚本</strong> <a class="header-anchor" href="#_7-运行项目生命周期脚本" aria-label="Permalink to “7. 运行项目生命周期脚本”">​</a></h4><ul><li>执行 <code>package.json</code> 中定义的： <ul><li><code>prepare</code>（在打包前运行）</li><li><code>prepublishOnly</code>（仅发布时运行）</li></ul></li></ul><hr><h3 id="三、关键机制解析" tabindex="-1">三、关键机制解析 <a class="header-anchor" href="#三、关键机制解析" aria-label="Permalink to “三、关键机制解析”">​</a></h3><h4 id="✅-1-确定性安装-deterministic-install" tabindex="-1">✅ 1. <strong>确定性安装（Deterministic Install）</strong> <a class="header-anchor" href="#✅-1-确定性安装-deterministic-install" aria-label="Permalink to “✅ 1. 确定性安装（Deterministic Install）”">​</a></h4><ul><li><code>package-lock.json</code> 确保：<br><strong>无论何时、何地执行 <code>npm install</code>，结果都完全一致</strong>。<br> （对比：<code>yarn</code> 用 <code>yarn.lock</code>，<code>pnpm</code> 用 <code>pnpm-lock.yaml</code>）</li></ul><h4 id="✅-2-缓存机制" tabindex="-1">✅ 2. <strong>缓存机制</strong> <a class="header-anchor" href="#✅-2-缓存机制" aria-label="Permalink to “✅ 2. 缓存机制”">​</a></h4><ul><li><strong>HTTP 缓存</strong>：避免重复请求 registry；</li><li><strong>内容缓存</strong>：相同 integrity 的包只存储一份；</li><li><strong>CI 优化</strong>：可缓存 <code>~/.npm</code> 目录加速后续构建。</li></ul><h4 id="✅-3-安全校验" tabindex="-1">✅ 3. <strong>安全校验</strong> <a class="header-anchor" href="#✅-3-安全校验" aria-label="Permalink to “✅ 3. 安全校验”">​</a></h4><ul><li>每个包的 <code>integrity</code> 字段（SHA-512）用于验证下载内容未被篡改；</li><li>若校验失败，安装中止。</li></ul><hr><h3 id="四、常见问题与行为" tabindex="-1">四、常见问题与行为 <a class="header-anchor" href="#四、常见问题与行为" aria-label="Permalink to “四、常见问题与行为”">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>npm 行为</th></tr></thead><tbody><tr><td><strong><code>npm install</code>（无参数）</strong></td><td>按 <code>package-lock.json</code> 安装，忽略 <code>package.json</code> 中的版本范围</td></tr><tr><td><strong><code>npm install pkg</code></strong></td><td>更新 <code>package.json</code> + <code>package-lock.json</code>，安装最新兼容版本</td></tr><tr><td><strong>删除 <code>node_modules</code> 后重装</strong></td><td>结果与之前完全一致（因 lock 文件存在）</td></tr><tr><td><strong>修改 <code>package.json</code> 后 install</strong></td><td>重新计算受影响子树，更新 lock 文件</td></tr></tbody></table><hr><h3 id="五、与其他包管理器对比" tabindex="-1">五、与其他包管理器对比 <a class="header-anchor" href="#五、与其他包管理器对比" aria-label="Permalink to “五、与其他包管理器对比”">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th>npm</th><th>Yarn</th><th>pnpm</th></tr></thead><tbody><tr><td><strong>依赖结构</strong></td><td>扁平化（可能重复）</td><td>扁平化</td><td><strong>硬链接 + 符号链接</strong>（无重复）</td></tr><tr><td><strong>lock 文件</strong></td><td><code>package-lock.json</code></td><td><code>yarn.lock</code></td><td><code>pnpm-lock.yaml</code></td></tr><tr><td><strong>安装速度</strong></td><td>中等</td><td>快（并行下载）</td><td><strong>极快</strong>（无文件复制）</td></tr><tr><td><strong>磁盘占用</strong></td><td>高</td><td>中</td><td><strong>极低</strong></td></tr></tbody></table><hr><h3 id="六、一句话总结-9" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-9" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong><code>npm install</code> 的本质是一次“依赖决议 + 安全分发 + 状态固化”的过程——它通过 lock 文件确保可复现性，通过扁平化减少冗余，通过缓存和校验平衡速度与安全。</strong></p></blockquote><h2 id="npm-run-start-的整个过程" tabindex="-1">npm run start 的整个过程？ <a class="header-anchor" href="#npm-run-start-的整个过程" aria-label="Permalink to “npm run start 的整个过程？”">​</a></h2><p><code>npm run start</code> 的执行过程，本质上是 <strong>Node.js 调用 npm CLI，解析并运行 <code>package.json</code> 中定义的 <code>start</code> 脚本命令</strong>。整个流程涉及 <strong>Shell 环境、脚本执行、进程管理</strong> 等多个环节。以下是详细分解：</p><hr><h3 id="一、整体执行流程" tabindex="-1">一、整体执行流程 <a class="header-anchor" href="#一、整体执行流程" aria-label="Permalink to “一、整体执行流程”">​</a></h3><p><img src="/vitepress_docs/assets/tongyi-mermaid-2026-01-05-140503.CKeE76J1.png" alt="An Image"></p><hr><h3 id="二、详细步骤解析" tabindex="-1">二、详细步骤解析 <a class="header-anchor" href="#二、详细步骤解析" aria-label="Permalink to “二、详细步骤解析”">​</a></h3><h4 id="_1-解析命令" tabindex="-1">1. <strong>解析命令</strong> <a class="header-anchor" href="#_1-解析命令" aria-label="Permalink to “1. 解析命令”">​</a></h4><ul><li>终端（如 Bash、Zsh、PowerShell）将 <code>npm run start</code> 交给 <strong>npm CLI</strong>（全局安装的 <code>npm</code> 命令）；</li><li><code>run</code> 是 npm 的子命令，<code>start</code> 是传递给它的参数。</li></ul><h4 id="_2-定位项目根目录" tabindex="-1">2. <strong>定位项目根目录</strong> <a class="header-anchor" href="#_2-定位项目根目录" aria-label="Permalink to “2. 定位项目根目录”">​</a></h4><ul><li>npm 从当前目录向上递归查找 <strong><code>package.json</code> 文件</strong>，确定项目根路径；</li><li>若找不到 → 报错：<code>No package.json found</code>。</li></ul><h4 id="_3-读取-scripts-配置" tabindex="-1">3. <strong>读取 <code>scripts</code> 配置</strong> <a class="header-anchor" href="#_3-读取-scripts-配置" aria-label="Permalink to “3. 读取 scripts 配置”">​</a></h4><ul><li>解析 <code>package.json</code> 中的 <code>scripts</code> 字段：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vite&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 或 &quot;react-scripts start&quot;, &quot;node server.js&quot; 等</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>如果 <code>scripts.start</code> 不存在，npm <strong>不会报错</strong>（特殊行为！），而是尝试运行默认命令： <ul><li><strong>Node.js 项目</strong>：<code>node server.js</code></li><li><strong>但现代项目通常显式定义 <code>start</code>，避免歧义</strong>。</li></ul></li></ul><blockquote><p>⚠️ 注意：<br><code>npm start</code> 是 <code>npm run start</code> 的简写，两者等价。</p></blockquote><h4 id="_4-准备执行环境" tabindex="-1">4. <strong>准备执行环境</strong> <a class="header-anchor" href="#_4-准备执行环境" aria-label="Permalink to “4. 准备执行环境”">​</a></h4><p>npm 会为脚本设置以下环境变量（供脚本内部使用）：</p><ul><li><code>npm_config_*</code>：npm 配置项（如 <code>npm_config_registry</code>）</li><li><code>npm_package_*</code>：<code>package.json</code> 中的字段（如 <code>npm_package_name</code>）</li><li><code>PATH</code>：自动加入 <code>node_modules/.bin</code>，使本地安装的 CLI（如 <code>vite</code>, <code>webpack</code>）可直接调用。</li></ul><blockquote><p>✅ 例如：即使未全局安装 <code>vite</code>，也能在脚本中直接写 <code>vite</code>。</p></blockquote><h4 id="_5-在子-shell-中执行命令" tabindex="-1">5. <strong>在子 Shell 中执行命令</strong> <a class="header-anchor" href="#_5-在子-shell-中执行命令" aria-label="Permalink to “5. 在子 Shell 中执行命令”">​</a></h4><ul><li>npm 启动一个 <strong>新的子进程（child process）</strong>，通过系统 Shell（如 <code>/bin/sh</code>）执行脚本内容；</li><li>示例：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实际执行的命令（伪代码）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/bin/sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vite&#39;</span></span></code></pre></div></li><li>脚本中的多个命令可用 <code>&amp;&amp;</code>、<code>||</code>、<code>&amp;</code> 连接（如 <code>&quot;start&quot;: &quot;npm run clean &amp;&amp; vite&quot;</code>）。</li></ul><h4 id="_6-进程生命周期管理" tabindex="-1">6. <strong>进程生命周期管理</strong> <a class="header-anchor" href="#_6-进程生命周期管理" aria-label="Permalink to “6. 进程生命周期管理”">​</a></h4><ul><li>子进程（如 Vite 开发服务器）接管终端输入/输出；</li><li><strong>Ctrl+C</strong> 会向子进程发送 <code>SIGINT</code> 信号，触发优雅关闭；</li><li>若脚本退出码非 <code>0</code>，npm 会认为执行失败（CI 中会导致 pipeline 中断）。</li></ul><hr><h3 id="三、典型-start-脚本示例" tabindex="-1">三、典型 <code>start</code> 脚本示例 <a class="header-anchor" href="#三、典型-start-脚本示例" aria-label="Permalink to “三、典型 start 脚本示例”">​</a></h3><table tabindex="0"><thead><tr><th>项目类型</th><th><code>start</code> 脚本</th><th>实际启动进程</th></tr></thead><tbody><tr><td><strong>Vite</strong></td><td><code>&quot;start&quot;: &quot;vite&quot;</code></td><td>启动基于 ESBuild 的开发服务器</td></tr><tr><td><strong>Create React App</strong></td><td><code>&quot;start&quot;: &quot;react-scripts start&quot;</code></td><td>启动 Webpack Dev Server</td></tr><tr><td><strong>Next.js</strong></td><td><code>&quot;start&quot;: &quot;next start&quot;</code></td><td>启动生产服务器（需先 build）<br>（开发用 <code>dev</code> 脚本）</td></tr><tr><td><strong>自定义 Node 服务</strong></td><td><code>&quot;start&quot;: &quot;node src/server.js&quot;</code></td><td>直接运行 Node.js 应用</td></tr></tbody></table><blockquote><p>💡 注意：</p><ul><li><strong>开发服务器通常用 <code>dev</code> 脚本</strong>（如 <code>&quot;dev&quot;: &quot;vite&quot;</code>），而 <code>start</code> 多用于<strong>生产启动</strong>；</li><li>但 CRA 等工具链将 <code>start</code> 用于开发，属历史约定。</li></ul></blockquote><hr><h3 id="四、关键特性与注意事项" tabindex="-1">四、关键特性与注意事项 <a class="header-anchor" href="#四、关键特性与注意事项" aria-label="Permalink to “四、关键特性与注意事项”">​</a></h3><h4 id="✅-1-自动注入-node-modules-bin-到-path" tabindex="-1">✅ 1. <strong>自动注入 <code>node_modules/.bin</code> 到 PATH</strong> <a class="header-anchor" href="#✅-1-自动注入-node-modules-bin-到-path" aria-label="Permalink to “✅ 1. 自动注入 node_modules/.bin 到 PATH”">​</a></h4><ul><li>无需写完整路径：<br> ❌ <code>&quot;start&quot;: &quot;./node_modules/.bin/vite&quot;</code><br> ✅ <code>&quot;start&quot;: &quot;vite&quot;</code></li></ul><h4 id="✅-2-支持跨平台脚本-谨慎" tabindex="-1">✅ 2. <strong>支持跨平台脚本（谨慎）</strong> <a class="header-anchor" href="#✅-2-支持跨平台脚本-谨慎" aria-label="Permalink to “✅ 2. 支持跨平台脚本（谨慎）”">​</a></h4><ul><li>简单命令（如 <code>vite</code>）跨平台；</li><li>复杂 Shell 操作（如 <code>rm -rf</code>）需用跨平台库（如 <code>rimraf</code>）：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;clean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;rimraf dist&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="✅-3-环境变量传递" tabindex="-1">✅ 3. <strong>环境变量传递</strong> <a class="header-anchor" href="#✅-3-环境变量传递" aria-label="Permalink to “✅ 3. 环境变量传递”">​</a></h4><ul><li>可在命令前加环境变量（Unix-like）：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NODE_ENV=production node server.js&quot;</span></span></code></pre></div></li><li>Windows 需用 <code>cross-env</code>：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cross-env NODE_ENV=production node server.js&quot;</span></span></code></pre></div></li></ul><h4 id="❌-4-不要在-start-中运行长时间后台任务" tabindex="-1">❌ 4. <strong>不要在 <code>start</code> 中运行长时间后台任务</strong> <a class="header-anchor" href="#❌-4-不要在-start-中运行长时间后台任务" aria-label="Permalink to “❌ 4. 不要在 start 中运行长时间后台任务”">​</a></h4><ul><li><code>npm run start</code> 会<strong>阻塞终端</strong>，适合前台服务（如 Web 服务器）；</li><li>后台任务应使用 <code>pm2</code> 或系统服务管理。</li></ul><hr><h3 id="五、调试技巧" tabindex="-1">五、调试技巧 <a class="header-anchor" href="#五、调试技巧" aria-label="Permalink to “五、调试技巧”">​</a></h3><h4 id="_1-查看实际执行命令" tabindex="-1">1. <strong>查看实际执行命令</strong> <a class="header-anchor" href="#_1-查看实际执行命令" aria-label="Permalink to “1. 查看实际执行命令”">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dry-run</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或启用 verbose 日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --loglevel=silly</span></span></code></pre></div><h4 id="_2-检查-path-是否包含-bin" tabindex="-1">2. <strong>检查 PATH 是否包含 .bin</strong> <a class="header-anchor" href="#_2-检查-path-是否包含-bin" aria-label="Permalink to “2. 检查 PATH 是否包含 .bin”">​</a></h4><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;debug-path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;echo $PATH&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="_3-手动模拟执行" tabindex="-1">3. <strong>手动模拟执行</strong> <a class="header-anchor" href="#_3-手动模拟执行" aria-label="Permalink to “3. 手动模拟执行”">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入项目目录后</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vite</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 等价于 npm run start（若 start=vite）</span></span></code></pre></div><hr><h3 id="六、一句话总结-10" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-10" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong><code>npm run start</code> 是 npm 根据 <code>package.json</code> 启动一个子进程来运行开发或生产服务器——它自动配置环境、注入本地 CLI，并将控制权交给实际的构建工具（如 Vite/Webpack），是前端项目启动的标准入口。</strong></p></blockquote><h2 id="对-css-工程化的理解" tabindex="-1">对 CSS 工程化的理解 <a class="header-anchor" href="#对-css-工程化的理解" aria-label="Permalink to “对 CSS 工程化的理解”">​</a></h2><p><strong>CSS 工程化</strong>是指将 CSS 代码纳入现代软件工程体系，通过<strong>模块化、自动化、可维护性设计和工具链支持</strong>，解决传统 CSS 在大型项目中面临的<strong>全局污染、命名冲突、复用困难、维护成本高</strong>等问题，使其具备与 JavaScript 相同的工程能力。</p><hr><h3 id="一、传统-css-的痛点-为什么需要工程化" tabindex="-1">一、传统 CSS 的痛点（为什么需要工程化？） <a class="header-anchor" href="#一、传统-css-的痛点-为什么需要工程化" aria-label="Permalink to “一、传统 CSS 的痛点（为什么需要工程化？）”">​</a></h3><table tabindex="0"><thead><tr><th>问题</th><th>表现</th></tr></thead><tbody><tr><td><strong>全局作用域</strong></td><td><code>.button { ... }</code> 会污染整个页面</td></tr><tr><td><strong>命名冲突</strong></td><td>多人协作时类名重复覆盖</td></tr><tr><td><strong>复用困难</strong></td><td>相同样式需复制粘贴（违反 DRY）</td></tr><tr><td><strong>无逻辑能力</strong></td><td>无法使用变量、函数、条件等编程特性</td></tr><tr><td><strong>依赖不明确</strong></td><td>不清楚某个 CSS 文件被哪些组件使用</td></tr></tbody></table><hr><h3 id="二、css-工程化的核心目标" tabindex="-1">二、CSS 工程化的核心目标 <a class="header-anchor" href="#二、css-工程化的核心目标" aria-label="Permalink to “二、CSS 工程化的核心目标”">​</a></h3><ol><li><strong>局部作用域（Scoped Styles）</strong><br> → 样式只作用于当前组件，避免全局污染。</li><li><strong>模块化与复用</strong><br> → 像 JS 模块一样导入/导出样式。</li><li><strong>提升开发体验</strong><br> → 支持变量、嵌套、函数等编程特性。</li><li><strong>可维护性与可扩展性</strong><br> → 结构清晰，易于团队协作。</li><li><strong>性能优化</strong><br> → 自动压缩、提取关键 CSS、按需加载。</li></ol><hr><h3 id="三、主流-css-工程化方案" tabindex="-1">三、主流 CSS 工程化方案 <a class="header-anchor" href="#三、主流-css-工程化方案" aria-label="Permalink to “三、主流 CSS 工程化方案”">​</a></h3><h4 id="✅-1-css-modules-基于文件的局部作用域" tabindex="-1">✅ 1. <strong>CSS Modules（基于文件的局部作用域）</strong> <a class="header-anchor" href="#✅-1-css-modules-基于文件的局部作用域" aria-label="Permalink to “✅ 1. CSS Modules（基于文件的局部作用域）”">​</a></h4><ul><li><strong>原理</strong>：构建时将类名哈希化，生成唯一标识。<div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* button.module.css */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.primary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> styles </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./button.module.css&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 实际类名 → primary__aB3cD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{styles.primary}&gt;Click&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><strong>优点</strong>：简单、兼容所有框架；</li><li><strong>缺点</strong>：动态类名处理麻烦，调试时类名不可读。</li></ul><h4 id="✅-2-css-in-js-样式写在-js-中" tabindex="-1">✅ 2. <strong>CSS-in-JS（样式写在 JS 中）</strong> <a class="header-anchor" href="#✅-2-css-in-js-样式写在-js-中" aria-label="Permalink to “✅ 2. CSS-in-JS（样式写在 JS 中）”">​</a></h4><ul><li><strong>代表库</strong>：styled-components（React）、Emotion；</li><li><strong>示例</strong>：<div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Button</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> styled.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">button</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  color: ${</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">props</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> props</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">primary</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;blue&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;gray&#39;};</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  padding: 8px 16px;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></li><li><strong>优点</strong>： <ul><li>完全局部作用域；</li><li>支持 JS 逻辑（props、状态）；</li><li>自动 vendor prefix、主题切换。</li></ul></li><li><strong>缺点</strong>： <ul><li>运行时开销；</li><li>SSR 需额外处理；</li><li>学习成本高。</li></ul></li></ul><h4 id="✅-3-scoped-css-单文件组件方案" tabindex="-1">✅ 3. <strong>Scoped CSS（单文件组件方案）</strong> <a class="header-anchor" href="#✅-3-scoped-css-单文件组件方案" aria-label="Permalink to “✅ 3. Scoped CSS（单文件组件方案）”">​</a></h4><ul><li><strong>代表</strong>：Vue SFC、Svelte；</li><li><strong>原理</strong>：编译时为组件内 CSS 添加属性选择器。<div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scoped</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 编译后 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;button&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> data-v-f3f3eg9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Click&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data-v-f3f3eg9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><strong>优点</strong>：开发体验无缝，零配置；</li><li><strong>缺点</strong>：仅限特定框架。</li></ul><h4 id="✅-4-原子化-css-utility-first" tabindex="-1">✅ 4. <strong>原子化 CSS（Utility-First）</strong> <a class="header-anchor" href="#✅-4-原子化-css-utility-first" aria-label="Permalink to “✅ 4. 原子化 CSS（Utility-First）”">​</a></h4><ul><li><strong>代表</strong>：Tailwind CSS、Windi CSS；</li><li><strong>思想</strong>：用原子类组合样式，而非语义化类名。<div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text-blue-500 px-4 py-2 rounded&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Click&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><strong>优点</strong>： <ul><li>极致复用，无冗余 CSS；</li><li>设计系统一致性高；</li><li>Tree Shaking 移除未用样式。</li></ul></li><li><strong>缺点</strong>： <ul><li>HTML 可读性下降；</li><li>需要学习新语义。</li></ul></li></ul><hr><h3 id="四、配套工程化能力" tabindex="-1">四、配套工程化能力 <a class="header-anchor" href="#四、配套工程化能力" aria-label="Permalink to “四、配套工程化能力”">​</a></h3><h4 id="🔧-1-预处理器-preprocessors" tabindex="-1">🔧 1. <strong>预处理器（Preprocessors）</strong> <a class="header-anchor" href="#🔧-1-预处理器-preprocessors" aria-label="Permalink to “🔧 1. 预处理器（Preprocessors）”">​</a></h4><ul><li><strong>Sass/Less/Stylus</strong>：提供变量、嵌套、混合（mixin）等；<div class="language-scss"><button title="Copy Code" class="copy"></button><span class="lang">scss</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$primary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">#007bff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.btn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  color</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$primary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:hover</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">opacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h4 id="🔧-2-postcss-css-后处理" tabindex="-1">🔧 2. <strong>PostCSS（CSS 后处理）</strong> <a class="header-anchor" href="#🔧-2-postcss-css-后处理" aria-label="Permalink to “🔧 2. PostCSS（CSS 后处理）”">​</a></h4><ul><li><strong>作用</strong>：对编译后的 CSS 进行转换；</li><li><strong>常用插件</strong>： <ul><li><code>autoprefixer</code>：自动加浏览器前缀；</li><li><code>postcss-preset-env</code>：使用未来 CSS 语法；</li><li><code>cssnano</code>：压缩 CSS。</li></ul></li></ul><h4 id="🔧-3-构建集成" tabindex="-1">🔧 3. <strong>构建集成</strong> <a class="header-anchor" href="#🔧-3-构建集成" aria-label="Permalink to “🔧 3. 构建集成”">​</a></h4><ul><li>Webpack / Vite 通过 loader/plugin 处理 CSS： <ul><li><code>css-loader</code>：解析 <code>@import</code> 和 <code>url()</code>；</li><li><code>MiniCssExtractPlugin</code>：提取 CSS 到独立文件；</li><li><code>PurgeCSS</code>：移除未使用的 CSS（配合 Tailwind）。</li></ul></li></ul><h4 id="🔧-4-设计系统与主题" tabindex="-1">🔧 4. <strong>设计系统与主题</strong> <a class="header-anchor" href="#🔧-4-设计系统与主题" aria-label="Permalink to “🔧 4. 设计系统与主题”">​</a></h4><ul><li>通过 CSS Variables 实现动态主题：<div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  --color-primary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">#007bff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.dark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  --color-primary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">#4da6ff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">--color-primary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); }</span></span></code></pre></div></li></ul><hr><h3 id="五、选型建议" tabindex="-1">五、选型建议 <a class="header-anchor" href="#五、选型建议" aria-label="Permalink to “五、选型建议”">​</a></h3><table tabindex="0"><thead><tr><th>项目类型</th><th>推荐方案</th></tr></thead><tbody><tr><td><strong>React 新项目</strong></td><td>Tailwind CSS + CSS Modules（或 Emotion）</td></tr><tr><td><strong>Vue 项目</strong></td><td>Scoped CSS + Sass</td></tr><tr><td><strong>设计驱动产品</strong></td><td>Tailwind CSS（快速实现 UI 一致性）</td></tr><tr><td><strong>高定制化组件库</strong></td><td>CSS Modules + PostCSS</td></tr><tr><td><strong>追求极致性能</strong></td><td>原子化 CSS + PurgeCSS</td></tr></tbody></table><hr><h3 id="六、一句话总结-11" tabindex="-1">六、一句话总结 <a class="header-anchor" href="#六、一句话总结-11" aria-label="Permalink to “六、一句话总结”">​</a></h3><blockquote><p><strong>CSS 工程化不是“用什么工具”，而是“如何让样式具备模块化、可维护、可协作的工程属性”——它通过作用域隔离、编程能力增强和自动化工具链，将 CSS 从“全局脚本”升级为“一等公民模块”。</strong></p></blockquote></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/vitepress_docs/" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>首页</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"DwaEFGJT\",\"code-practice_index.md\":\"BUINmHd7\",\"ergou-plans.md\":\"Bnm20A3n\",\"index.md\":\"wCcMsz-a\",\"interview-questions_brower.md\":\"4-LQ_nCR\",\"interview-questions_css.md\":\"CNplvfg2\",\"interview-questions_front-end-engineering.md\":\"jcOw1uo6\",\"interview-questions_html.md\":\"DEU37n38\",\"interview-questions_index.md\":\"CNepLkI-\",\"interview-questions_javascript.md\":\"Nm1hP7ok\",\"js数据结构与算法_1-算法基础概念.md\":\"Dy9_i1bQ\",\"markdown-examples.md\":\"CdJoS9U5\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"二狗摸鱼\",\"description\":\"A VitePress Site\",\"base\":\"/vitepress_docs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Examples\",\"link\":\"/markdown-examples\"}],\"sidebar\":[{\"text\":\"Examples\",\"items\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"前端面试题\",\"link\":\"/interview-questions\"},{\"text\":\"Runtime API Examples\",\"link\":\"/api-examples\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}],\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>